---
title: "Clasifiación"
author: "JLMR"
date: 2019-04-18T21:14:14-05:00
categories: ["R"]
tags: ["LDA", "KNN"]
mathjax : true
menu:
  main:
    name: Clustering
    weight: 18
---



<div id="clustering." class="section level2">
<h2>Clustering.</h2>
<p>Un escenario de análisis en el que tenemos una serie de características y deseamos clasificar las observaciones de acuerdo a su similitud corresponde con un típico problema de <strong>CLUSTERING</strong>. En especial podemos abordarlo desde la perspectiva de <em>unsupervised learning</em> (no hay variable dependiente natural que deseamos predecir, lo que buscamos es clasificar.)</p>
<p>A diferencia de los otros enfoques (R Lineal (MCO), R Logística), en este método no estamos tratando de predecir una variable dependiente, más bien buscamos determinar a qué grupo pertenece cada observación. Y por supuesto es posible determinar la precisión con la que hacemos la predicción de la categoría a la que pertenece una determinada oobservación.</p>
</div>
<div id="k-nearest-neighbors" class="section level2">
<h2>K-Nearest Neighbors</h2>
<p>Método no paramétrico. ie, no asume que los datos toman una forma funcional predeterminada.</p>
<p>Calcula la distancia de un punto x en el espacio (generalmente <strong>Euclidiano</strong>, no obstante hay otras posibilidades para determinar la distancia como la similitud coseno) con el resto de las observaciones.</p>
<p>Un supuesto central de este algoritmo es que observaciones que son similares tenderan a localizarse cerca.</p>
<div class="figure">
<img src="/img/knn.jpg" />

</div>
</div>
<div id="teoria." class="section level2">
<h2>Teoría.</h2>
</div>
<div id="implementacion" class="section level2">
<h2>Implementación:</h2>
<p>Dos puntos importantes para la implementación, la clasificación es para variables categóricas por definición pero las variables explicativas (features) idealmente son numéricas, este modelo no tiene un buen desempeño cuando usamos variables categóricas como insumo o cuando el número de dimensiones <em>p</em>, (var explicativas) es muy grande (p&gt;3).</p>
<p>Un parámetro importante en la estimación de este modelo es el nÚmero de observaciones que debemos considerar para determinar a qué categoría pertenece la observación sobre la que se hace la predicción. <strong>K</strong> Una práctica común en términos empíricos es considerar <span class="math inline">\(k =\sqrt(n)\)</span>. Donde <strong>n</strong> es el número de observacones del conjunto de datos de contraste.</p>
<p>Como parte de la aplicación de este modelo validaremos la precisión mediante la estrategia de contrsate entre un conjunto de datos de entrenamiento (<strong>train data set</strong>), que esta integrado por la proporción de datos que usaremos para estimar el modelo (generalmente <span class="math inline">\(80%\)</span>) del total de los datos disponibles. Y un cnjunto de datos de validación (<strong>test data set</strong>, usualmente la proporción restante de datos ej. 2<span class="math inline">\(0%\)</span>).</p>
<p>Para aplicar la estrategia de validación y determinar el nivel de precisión alcanzado por el modelo, necesitamos constrir una <strong>matriz de contraste</strong> que nos indica cuantos casos son calsificados correctamente y cuantos son clasificados de forma incorrecta.</p>
<p><img src="/img/cfm.jpg" /> Note los elementos de la diagonal (2, 4 )(son predicciones correctas.</p>
<p>Tres indicadores son de interés para la validación:</p>
<ol style="list-style-type: decimal">
<li>El <strong>precisión score</strong> que mide la fracción de la predicción que fue correcta <strong>respecto a todas</strong> las categorías. (max. val 100).</li>
</ol>
<p><strong>Precision score</strong> =<span class="math display">\[\frac{tp}{tp+fp}\]</span> Donde <strong>tp</strong>. fracción de observaciones clasificadas correctamente (predicción positiva para observación positiva. Y <strong>fp</strong> falso positivo).<br />
la fracción de la predicción que fue correcta <strong>respecto a todas</strong> las categorías. (max. val 100).</p>
<div class="figure">
<img src="\img\precision.jpg" />

</div>
<ol start="2" style="list-style-type: decimal">
<li>El indicador de <strong>sensitividad</strong> (<em>recall</em>) que mide la fracción clasificada correctamente de entre los registros positivos unicamente. <span class="math display">\[\frac{tp}{tp+fn}\]</span></li>
</ol>
<div class="figure">
<img src="\img\sensitivity_recall.jpg" />

</div>
<p>El <em>F score</em>, este indicador considera el los dos anteriores al estimar una media armómica no aritmética. Ya que es posible tener modelos con valores elevados del sensitividad (recall) y valores pequeños de <strong>precisión</strong>. Esta medida pondera ambos. <span class="math display">\[F1=\frac{2*recall*precision}{recall+ precision}\]</span></p>
<p>En la práctica el uso de la medida de validación dependerá del probkema estuduado (ej. de los costos de claficar incorrectamente los datos.)</p>
<p>(accuracy score), así como el factor de precisión f1.</p>
<div id="ejemplo-1." class="section level3">
<h3>Ejemplo 1.</h3>
<div id="descripcion" class="section level5">
<h5>Descripción</h5>
</div>
<div id="clasifiacion-de-personas" class="section level5">
<h5>Clasifiación de personas:</h5>
<p>Conisdere un escenario sobre transacciones realizadas en una tienda departamental en el que se busca determinar el comportamiento de las personas a partir de algunas características de las transacciones como el valor de compras y la ocupación de la persona.</p>
<p>Este es un problema de clasificación en el que buscamos determinar si la persona es hombre o mujer (variable target) con base en dos variables explicativas el monto gastado en sus compras y su ocupación.</p>
<p><strong>Implementación:</strong></p>
<ol style="list-style-type: lower-alpha">
<li>Estime el modelo con un parámetro <strong>K=3</strong> y genere la predicción para el sexo de la persona utilizando las variables: <em>Purchase</em> y <em>Occupation</em>.</li>
</ol>
<p>Para la estimación del modelo considere una proporción del <span class="math inline">\(30 \%\)</span> para separar la base de datos de entrenamiento (train) de la base de validación (test). Y un parametro <span class="math inline">\(k=\sqrt(n)\)</span> Donde n es el numero de observaciones del conjunto de datos de contraste (y_test).</p>
<ol start="2" style="list-style-type: lower-alpha">
<li><p>Estime el nivel de precisión del modelo.(i.e.¿Cuál es el porcentaje de casos clasificados correctamente? Genere la matriz de contrsate y estime el score de precisión.</p></li>
<li><p>Determine el valor de cluster óptimo. (ie. el valor de k , para el que el score de precisión es el mas alto.)</p></li>
<li><p>Grafique sus resultados.</p></li>
</ol>
</div>
</div>
</div>
<div id="linear-discriminant-analysis-lda." class="section level2">
<h2>Linear Discriminant Analysis LDA.</h2>
<p>Una ventaja de este <strong>método de clasificación</strong> respecto a otros como por ejemplo Modelos de <strong>regresión logística</strong> es que podemos aplicarlos a <span class="math inline">\(k&gt;2 target variables\)</span>. En el modelo de regresión logísitica generalmente nuestra variable target de predicción tenemos dos ategorias (i.e la variable dependiente es dicotómica), si bien es posible estimar el modelo para k&gt;2, la especificación logit en esos casos suele no ser tan estable).</p>
<p>El método de elección para esta tarea (<span class="math inline">\(k&gt;2\)</span>) es <strong>LDA</strong></p>
<p>tdl…</p>
<p>Inlcuir <em>Cross-Validation</em> ISL Chp.5. after logistic.</p>
</div>
