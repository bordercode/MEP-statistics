---
title: "Multiple Models"
author: "JLMR"
date: 2018-12-28T21:14:14-05:00
categories: ["R"]
tags: ["Regresión Lineal", "MCO", "regression"]
mathjax : true
menu:
  main:
    name: RL-Multiple Cross-Section 
    weight: 11
---

## Programación Funcional. 

##### Estimación de Multiples Modelos de regression Lineal.


Considere un escenario en el que nos interesa modelar la relación entre la **esperanza de vida** y el PIB (una variable que representa el nivel económico de un país) o bien un indicador clásico como el indice de desarollo Humano  y su evolución  a lo largo del tiempo. 

El problema en este caso es que la unidad de análisis (142 países) implica la realización de  un gran número de modelos, 142 modelos!!! ¿Cómo podemos atender esta tarea de estimar 142 modelos de regresión lineal de una forma eficiente?

Una opción que se usa por el [sitio oficial](http://hdr.undp.org/en/data) del programa de Naciones Unidas para el desarrollo. Es presentar la relación entre variables mediante graficas de lineas:
![](/img/onu.jpg)

No obstante, el enfoque visual utilizado  de **ONU** no permite una observarción  precisa. Cada linea representa uno de los 142 paises!! 

Alternativamtene podemos representar la información usando las herramientas de visualización en **R** que ya conocemos. 

![](/img/continents.gif)


![](/img/p.gif)

Ahora el reto es generar un modelo de regresión lineal para cada país. El enfoque que usaremos es mediante **programación funcional**

El objetivo es contar con **una** representación visual del comportamiento de la **variable dependiente** (en este caso el incremento anual de la **esperanza de vida**) aunado a los parámetros básicos que describen el desempeño del modelo como el coeficiente de determianción **R^2** para cada país.

La siguiente gráfica muestra una aplicación de este concepto.

```{r,echo=FALSE}
library(gapminder)
library(dplyr)
library(purrr)
library(tidyr)
library(ggplot2)
```

Observen que para la mayoría de estos países el modelo se ajsuta bastante bien ($R^2\approx.97$), sin embargo para un grupo de paises particular el modelo parece no tener un ajuste adecuado? 

¿Qué tienen estos países en comun?

Bueno,  al parecer todos estos paises son de África, ¿Por qué el modelo de regresión lineal en este caso no se ajusta tan bien como en la mayoría de los países? 


Para lograr el análisis necesitamos  tres fases:

+ tidy data con library(dplyr) 

![](/img/nested.jpg)
+ functional programming con library(purrr) y

+ tidy modelos con library(broom). 




