<!DOCTYPE html>
<html class="no-js" lang="en-us">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<meta http-equiv="X-UA-Compatible" content="IE=edge">
	<title>PCA</title>
	<script>(function(d,e){d[e]=d[e].replace("no-js","js");})(document.documentElement,"className");</script>
	<meta name="description" content="">
	<meta name="generator" content="Hugo 0.54.0" />
	<meta property="og:title" content="PCA" />
<meta property="og:description" content="Análisis de Componentes Principales (PCA).MotivaciónEl método PCA permite reexpresar un conjunto multidimensional de datos (ej. k dimensiones) que contiene variables correlacionadas ( ej. que aportan información redundante), en un subconjnto de datos de menor dimensión.
Con PCA respondemos preguntas como:
¿Qué variables estan correlacionadas?
¿Podemos representar los datos de una manera más clara ej.mediante un menor número de dimensiones?
¿Qué variables tienen la mayor influencia para explicar la variación de los datos?" />
<meta property="og:type" content="article" />
<meta property="og:url" content="/post/2019-02-24-pca/" />
<meta property="article:published_time" content="2019-01-28T21:14:14-05:00"/>
<meta property="article:modified_time" content="2019-01-28T21:14:14-05:00"/>

	
	<link rel="dns-prefetch" href="//fonts.googleapis.com">
	<link rel="dns-prefetch" href="//fonts.gstatic.com">
	<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:400,400i,700">
	<link rel="stylesheet" href="/css/style.css">
	<link rel="shortcut icon" href="/favicon.ico">
		
<script type="application/javascript">
var doNotTrack = false;
if (!doNotTrack) {
	window.ga=window.ga||function(){(ga.q=ga.q||[]).push(arguments)};ga.l=+new Date;
	ga('create', 'UA-124338825-1', 'auto');
	
	ga('send', 'pageview');
}
</script>
<script async src='https://www.google-analytics.com/analytics.js'></script>

</head>
<body class="body">
	<div class="container container--outer">
		<header class="header">
	<div class="container">
		<div class="logo">
			<a class="logo__link" href="/" title="Estadística II" rel="home">
				<div class="logo__title">Estadística II</div>
				<div class="logo__tagline">Semestre II MEP 2019</div>
			</a>
		</div>
		
<nav class="menu">
	<button class="menu__btn" aria-haspopup="true" aria-expanded="false" tabindex="0">
		<span class="menu__btn-title" tabindex="-1">Menu</span>
	</button>
	<ul class="menu__list">
		<li class="menu__item">
			<a class="menu__link" href="/about/">Maestría en estudios de población</a>
		</li>
		<li class="menu__item">
			<a class="menu__link" href="/post/syllabus/">Syllabus</a>
		</li>
		<li class="menu__item">
			<a class="menu__link" href="/post/2015-07-23-rl/">Regresion Lineal</a>
		</li>
		<li class="menu__item">
			<a class="menu__link" href="/post/2019-01-11-rl2/">RL-Simple</a>
		</li>
		<li class="menu__item">
			<a class="menu__link" href="/post/2019-01-15-rl3/">RL-Modelo</a>
		</li>
		<li class="menu__item">
			<a class="menu__link" href="/post/2019-01-25-rl4/">RL-Hipótesis</a>
		</li>
		<li class="menu__item">
			<a class="menu__link" href="/post/2019-01-25-rl5/">RL-Muiltiple</a>
		</li>
		<li class="menu__item">
			<a class="menu__link" href="/post/2019-02-05-rl6/">RL-Diagnóstico</a>
		</li>
		<li class="menu__item">
			<a class="menu__link" href="/post/2019-20-01-rl7-models/">RL-Multiple Cross-Section</a>
		</li>
		<li class="menu__item menu__item--active">
			<a class="menu__link" href="/post/2019-02-24-pca/">PCA</a>
		</li>
		<li class="menu__item">
			<a class="menu__link" href="/post/2019-02-25-logistic/">Logistic R</a>
		</li>
		<li class="menu__item">
			<a class="menu__link" href="/post/2019-04-15-logistic2/">Logistic2 R</a>
		</li>
		<li class="menu__item">
			<a class="menu__link" href="/post/2019-04-16-logistic3/">Logistic3 R</a>
		</li>
		<li class="menu__item">
			<a class="menu__link" href="/post/2019-04-19-clustering_knn/">Clustering</a>
		</li>
		<li class="menu__item">
			<a class="menu__link" href="/post/recursos-adicionales/">Recursos Adicionales</a>
		</li>
		<li class="menu__item">
			<a class="menu__link" href="/post/2018-12-30-ejercicios/">Ejercicios</a>
		</li>
	</ul>
</nav>

	</div>
</header>
		<div class="wrapper flex">
			<div class="primary">
			
<main class="main" role="main">
	<article class="post">
		<header class="post__header">
			<h1 class="post__title">PCA</h1>
			<div class="post__meta meta">
<div class="meta__item-datetime meta__item">
	<svg class="meta__icon icon icon-time" width="16" height="14" viewBox="0 0 16 16"><path d="m8-.0000003c-4.4 0-8 3.6-8 8 0 4.4000003 3.6 8.0000003 8 8.0000003 4.4 0 8-3.6 8-8.0000003 0-4.4-3.6-8-8-8zm0 14.4000003c-3.52 0-6.4-2.88-6.4-6.4000003 0-3.52 2.88-6.4 6.4-6.4 3.52 0 6.4 2.88 6.4 6.4 0 3.5200003-2.88 6.4000003-6.4 6.4000003zm.4-10.4000003h-1.2v4.8l4.16 2.5600003.64-1.04-3.6-2.1600003z"/></svg>
	<time class="meta__text" datetime="2019-01-28T21:14:14">January 28, 2019</time>
</div>

<div class="meta__item-categories meta__item">
	<svg class="meta__icon icon icon-category" width="16" height="16" viewBox="0 0 16 16"><path d="m7 2l1 2h8v11h-16v-13z"/></svg>
	<span class="meta__text"><a class="meta__link" href="/categories/r" rel="category">R</a></span>
</div>
</div>
		</header><div class="content post__content clearfix">
			
<script src="/rmarkdown-libs/htmlwidgets/htmlwidgets.js"></script>
<script src="/rmarkdown-libs/plotly-binding/plotly.js"></script>
<script src="/rmarkdown-libs/typedarray/typedarray.min.js"></script>
<script src="/rmarkdown-libs/jquery/jquery.min.js"></script>
<link href="/rmarkdown-libs/crosstalk/css/crosstalk.css" rel="stylesheet" />
<script src="/rmarkdown-libs/crosstalk/js/crosstalk.min.js"></script>
<link href="/rmarkdown-libs/plotly-htmlwidgets-css/plotly-htmlwidgets.css" rel="stylesheet" />
<script src="/rmarkdown-libs/plotly-main/plotly-latest.min.js"></script>


<div id="analisis-de-componentes-principales-pca." class="section level2">
<h2>Análisis de Componentes Principales (PCA).</h2>
<div id="motivacion" class="section level4">
<h4>Motivación</h4>
<p>El método <strong>PCA</strong> permite reexpresar un conjunto multidimensional de datos (ej. k dimensiones) que contiene variables <strong>correlacionadas</strong> ( ej. que aportan información redundante), en un subconjnto de datos de menor dimensión.</p>
<p>Con <strong>PCA</strong> respondemos preguntas como:</p>
<p>¿Qué variables estan correlacionadas?</p>
<p>¿Podemos representar los datos de una manera más clara ej.mediante un menor número de dimensiones?</p>
<p>¿Qué variables tienen la mayor influencia para explicar la variación de los datos?</p>
<p>En este entorno cada variable la consideramos una dimensión.</p>
<p>Como ejemplo de la estructura de datos considere <span class="math inline">\(x_i\)</span> la observación del individuo <em>i</em> tomado de la variable <strong>k</strong> donde i varia de <strong>i</strong> a <strong>I</strong> y k a <strong>K</strong> Entonces en esta estructura la idea es reeprezar los datos a partir de un número de k´s. menor.</p>
<p>El <strong>PCA</strong> es una técnica para descubrir como variables <strong>numéricas</strong> <strong>“covarian”</strong>.</p>
<p>La aplicación del método reduce a un subconjunto de dimensiones (componentes principales) la información original. En análisis multivariado el concepto <em>Synthetic variable</em> denota la escencia del PCA.<a href="#fn1" class="footnoteRef" id="fnref1"><sup>1</sup></a>.</p>
<p>La estructura de datos resultante maximiza la variación inherente al conjunto de datos.</p>
<p>Ej. Captura la mayor variación posible con el menor número posible de dimensiones.</p>
<p>Los componentes son <strong>combinaciones lineales de las variables originales</strong>, que controlan por el “ruido” (información redundante) en los datos. Nos interesa la <strong>señal</strong> no el <strong>ruido</strong>!</p>
<p>El <strong>componente principal</strong> (Eigenvector) es una combinación lineal de las variables consideradas para predicción. Este captura la mayor pate de la variación en las dimensiones consideradas.</p>
<p>Estos componentes resultantes de la combinación lineal <strong>no estan correlacionados entre sí</strong>.</p>
<div class="figure">
<img src="\img\pca1.jpg" />

</div>
<p>En la gráfica anterior el punto azul representa las coordenadas del valor promedio de las variables población y gasto en educación.</p>
<p>Note en este caso que la linea central en el primer panel captura la dirección por la que las dos variables se relacionan, en cierto sentido este vector sintetiza la relación entre las variables población y gasto en educación para una muestra de 100 ciudades.</p>
<p>Si tomamos este vector y lo rotamos de tal manera que sea paralelo al eje horizontal ahora vemos una segunda fuente de variación (un segundo vector que captura otra dimensión de la variación en los datos) correspondiente a la variación vertical (representada por la distancia entre cada observación y nuestro primer vector).</p>
<p>En este ejemplo el plano formado por el vector en verde lo denominamos componente principal del conjunto de datos. Note que un segundo componente principal se forma por el vector en azul.</p>
<div class="figure">
<img src="\img\pca2.jpg" />

</div>
<p>El método permite estimar la proporción de la variación que cada dimensión (componentes principales) captura, de tal forma que podemos identificar las variables de mayor relevancia para el análisis y conocer las variables correlacionadas.</p>
<p>Esa variación generalmente se representa mediante un <strong>Scree plot</strong> ( <strong>x</strong> axis componentes principales, <strong>y</strong> axis proporción de la varianza explicada).</p>
<p>En la estimación de <strong>PCA</strong>, el monto de la variación explicada que cada componente retiene se captura por el <strong>eigenvalor</strong> y se expresa como cociente de la variación total en los datos.</p>
<p>Uno de los uso de esta técnica es la construcción de modelos que permiten hacer clasificación como el modelo de regresión logistica (considerado parte del conjunto de GLM (<em>generalized linear models</em>)).</p>
<p>El proceso de PCA aplicado a un problema de clasificación es el siguiente:</p>
<p>1.-Partimos de un conjunto de datos que contienen k dimensiones. La técnica de PCA permite reducir estas dimensiones al determinar los <strong>eigenvectores</strong> y los correspondientes <strong>eigenvalores (loadings)</strong>, estos permiten determinar la proporción de la varianza explicada de cada componente con lo que se tiene un criterio para seleccionar aquellos que capturan la mayor varianza posible en el conjunto de los datos.</p>
<p>El número de eigenvectores a retener es una cuestión empírica que depende del escenario de análisis, si bien, un <em>Threshold</em> común es considerar aquellos pc que aportan <span class="math inline">\(\geq 85\%\)</span> de la varianza en los datos. de manera alternativa conservar aquellos Eigenvectores con Eigenvalores <span class="math inline">\(\lambda\geq1\)</span>.<a href="#fn2" class="footnoteRef" id="fnref2"><sup>2</sup></a></p>
<p>2.- En el caso supervisado la nueva estrucura de datos de menor dimensión generada por el PCA puede ser utilizada para estimar modelos categóricos (de aprendizaje supervisado. ej tenemos una variable target para predecir) como regresión logística, etc,.</p>
<p>Estos permiten determinar la probabilidad de pertenencia a una categoría determinada dado un conjunto de característcas que describen las unidades de análisis.</p>
<p>El domino de aplicación es amplio. Una aproximación inicial a su uso es en la <strong>visualización</strong>, un proceso fundamental para comprender como se comportan nuestros datos antes de aplicar modelos de mayor complejidad. (VSM Vector Support Machine, NN Neural Networks , RF Random Forest,etc.,).</p>
<p>El dominio de aplicación de PCA incluye estudios poblacionales en areas como, migración,salud pública, indicadores socioeconómicos, etc.</p>
</div>
<div id="elementos-teoricos." class="section level3">
<h3>Elementos teóricos.</h3>
<p>Antes de avanzar consideremos algunos fundamentos de algebra lineal necesarios para tener un mejor entendimiento de esta técnica:</p>
<p>Suponga que tiene la siguiente matriz con dimensiones mxn m=5, n=3</p>
<pre><code>##   Age Height  IQ
## 1  24    152 108
## 2  50    175 102
## 3  17    160  95
## 4  35    170  97
## 5  65    155  87</code></pre>
<p>Entonces podemos expresar el primer vector de esta matriz como <span class="math display">\[\vec{x_1}  = \begin{bmatrix} 24  \\152 \\ 108 \end{bmatrix}\]</span> Suponga que tenomos una matriz <em>A</em> nxn y un vector nx1 <strong>v</strong>. si multiplicamos <strong>v</strong> por <strong>A</strong> Obtenemos otro vector. La matriz <strong>A</strong>, ha realizado una transformación sobre el vector <strong>v</strong>.</p>
<div class="figure">
<img src="/img/matrix.jpg" />

</div>
<p>El producto resultante, la matriz transformada, cambió el tamaño, no la dirección del vector.</p>
<p><span class="math inline">\(\begin{bmatrix}2&amp;3\\1&amp;2\end{bmatrix} \begin{bmatrix}2\\5\end{bmatrix}=\begin{bmatrix}19\\12\end{bmatrix}\)</span></p>
<p>Recordemos la definición de Eigenvectores (vectores propios/característicos) y Eigenvalores. <strong>Eigenvectores</strong>. Un vector tal que cuando son transformados por el operador resultan en un múltiplo escalar de si mismos.</p>
<p>En otras palabras el vector característico <strong>v</strong> de una transformación lineal es un vector <span class="math inline">\(\neq0\)</span> que cambia únicamente por un factor escalar cuando se le aplica la transformación lineal.</p>
<p>En este contexto el escalar <span class="math inline">\(\lambda\)</span> es denominado Eigenvalor (valor propio, o característico).</p>
<p><span class="math inline">\(A\vec{v.}=\lambda \vec{v.}\)</span></p>
<p>Donde <strong>v</strong> es un Eigenvector, <span class="math inline">\(\lambda\)</span> el Eigenvalor y A una matriz cuadrada.</p>
<p>Para mayor referencia considere la definición en el <a href="https://drive.google.com/file/d/1QIETnbXFvpk1GOOoFnA5l0SL7QDytN6h/view?usp=sharing">Anton H</a>:</p>
<div class="figure">
<img src="\img\pca3.jpg" />

</div>
<p>La aplicación de la teoría de vectores es particularmente útil para estudiar problemas de dinámica poblacional.</p>
<p><a href="https://medium.com/@andrew.chamberlain/using-eigenvectors-to-find-steady-state-population-flows-cd938f124764">Sugerencia leer Post</a></p>
<p><strong>Matriz simétrica:</strong> Una matriz <span class="math inline">\(mxn\)</span> se dice que es simétrica si <span class="math inline">\(A^T =A\)</span></p>
<p>Por ejemplo:</p>
<p><span class="math display">\[\begin{bmatrix}1&amp;2&amp;3\\2&amp;4&amp;5\\3&amp;5&amp;6\end{bmatrix}\]</span> En general la imagen de un vector <strong>x</strong> ante la multiplicación por una matriz <strong>A</strong> difiere tanto en dirección como en magnitud.</p>
<p>Sin emabargo, en el caso especial donde <strong>x</strong> es un eigenvector de <strong>A</strong>; la multiplicación por <strong>A</strong> deja la dirección sin cambio.</p>
<p>Por ejemplo en <span class="math inline">\(\mathbb{R}^2\)</span> o <span class="math inline">\(\mathbb{R}^3\)</span> la multiplicación por <strong>A</strong> proyecta cada <strong>eigenvector</strong> <strong>x</strong> de <strong>A</strong> (en caso de existir), a lo largo de la misma linea de <strong>x</strong> que atraviesa el origen.</p>
<p>Dependiendo del signo y magnitud del eigenvalor <span class="math inline">\(\lambda\)</span> correspondiente a <strong>x</strong>, la operacción <span class="math inline">\(Ax=\lambda x\)</span> comprime o expande <strong>x</strong> por un factor igual a <span class="math inline">\(\lambda\)</span>, con una dirección inversa en el caso de que <span class="math inline">\(\lambda&lt;0\)</span>.</p>
<p>La siguiente figura disponible en Anton H. ilustra este efecto.</p>
<div class="figure">
<img src="\img\pca4.jpg" />

</div>
<p>Note de la discusión anterior que la ecuación <span class="math inline">\(Ax=\lambda x\)</span> puede escribirse como <span class="math inline">\(Ax=\lambda I x\)</span> o bien de manera equivalente como:</p>
<p><span class="math display">\[(\lambda I -A)x=0\]</span></p>
<p>Para que <span class="math inline">\(\lambda\)</span> sea un eigenvalor de <strong>A</strong>, esta ecuación debe tener una solución <span class="math inline">\(\neq0\)</span> para <strong>x</strong>. Lo cual ocurre <strong>si y sólo si</strong> si la matriz de coeficientes <span class="math inline">\((\lambda I -A)\)</span> tiene un determinate <span class="math inline">\(=0\)</span>.</p>
<p>La observación anterior se expresa por la ecuación característica:</p>
<p><span class="math display">\[det(\lambda I -A)=0\]</span> En palabras. Si <strong>A</strong> es una matriz nxn, entonces <span class="math inline">\(\lambda\)</span> es un eigen valor de <strong>A</strong> <strong>si y solo si</strong>, este satisface la <strong>ecuación característica</strong>.</p>
<p>El proceso de cálculo <strong>PCA</strong> se basa en estos fundamentos teóricos para la determinación de los <strong>eigenvectores</strong> y correspondientes <strong>eigenvalores</strong> de la matriz de datos.</p>
<p>Entonces los eigenvectores capturan la “dirección” principal en la que se ubican los datos en el espacio vectorial y los eigenvalores actuan como ponderadores para determinar la extensión de estos eigenvectores.</p>
<p><strong>Vectores ortogonales:</strong> Dos vectores se consideran ortogonales cuando su producto punto cumple:</p>
<p><span class="math display">\[\vec{u_.}\cdot \vec{v_.}=0\]</span></p>
<p><strong>Teorema:</strong></p>
<p>Sea <strong>A</strong> una matriz simétrica. Entonces, existen <strong>valores</strong> propios reales <span class="math inline">\(\lambda_1, \lambda_2,\lambda_3,...,\lambda_n,\)</span> y <strong>vectores</strong> propios ortogonales <span class="math inline">\(\vec{v_1},\vec{v_2},\vec{v_3},...\vec{v_n}\neq 0\)</span><br />
tal que <span class="math inline">\(A\vec{v_i}=\lambda \vec{v_i}\)</span> para <span class="math inline">\(i=1,2,...,n\)</span></p>
<p>Adicionalmente consideremos las siguientes observaciones:</p>
<ol style="list-style-type: decimal">
<li>Sea <span class="math inline">\(A \in \mathbb{R}\)</span> una matriz mXn. Entoces tanto <span class="math inline">\(A^T \cdot A\)</span> como <span class="math inline">\(A \cdot A^T\)</span> son simétricas.</li>
</ol>
<p><span class="math inline">\((AA^T)^T=(A^T)^T \cdot A^T=A \cdot A^T\)</span></p>
<p><span class="math inline">\((A^T A)^T=A^T \cdot (A^T)^T=A^T A\)</span></p>
<p>2.- Sea A una matriz mxn. Entonces la matriz <span class="math inline">\(AA^T\)</span> y <span class="math inline">\(A^TA\)</span> tienen los mismos valores propios <span class="math inline">\(\neq0\)</span></p>
<p>Considere un vector propio <span class="math inline">\(v\)</span> <span class="math inline">\(\neq0\)</span> de <span class="math inline">\(A^TA\)</span> con valor propio <span class="math inline">\(\lambda \neq0\)</span> ej. <span class="math inline">\((A^TA)v=\lambda v\)</span></p>
<p>Ahora si multiplicamos la matriz anterior por A tenemos <span class="math display">\[(AA^T)(Av)=\lambda(Av)\]</span> Lo que implica que <span class="math inline">\(Av\)</span> es un vector propio de <span class="math inline">\(A A^T\)</span> con Eigenvalor <span class="math inline">\(\lambda\)</span>. Entonces los valores característicos de <span class="math inline">\(A^TA\)</span> son los mismos que <span class="math inline">\(AA^T\)</span>.</p>
<p>El uso de esta propuesta es importante por que permite simplificar el computo para estimar los eigenvalores por ejemplo considere una matriz de 400x3 entonces <span class="math inline">\(AA^T\)</span> es una matriz de 400X400 con 400 <span class="math inline">\(\lambda\)</span>’s pero <span class="math inline">\(A^TA\)</span> tiene solo 3 <span class="math inline">\(\lambda\)</span>’s,</p>
<p><strong>Para enfatizar:</strong></p>
<p>Con la técnica de PCA determinamos los vectores propios, estos vectores capturan el espacio común a lo largo del cuál se registra la variación de los datos y los valores propios, que dan cuenta de la magnitud de la varianza que cada vector propio explica.</p>
<p>Para comprender el potencial del uso de PCA en el análisis de datos primero ubiquemos el proceso que sigue esta técnica en el esquema más amplio del análisis y en seguida haremos una serie de ejemplos comenzando con una aplicación para una matriz de 500+ , 30.</p>
</div>
</div>
<div id="el-proceso-de-calculo." class="section level2">
<h2>El proceso de cálculo.</h2>
<p>Primero obtenemos la media de las <strong>m</strong> variables en nuestra matriz. Y almacenamos estos valores en un vector en el espacio <span class="math inline">\(\mathbb{R}^m\)</span></p>
<p><span class="math inline">\(\vec{\mu}=\frac{1}{n-1}(\vec{x}_1+\vec{x}_2+\ldots+\vec{x}_n)\)</span></p>
<p>En segundo lugar estandarizamos los datos (media cero, desviación estándar=1), este paso permite homogeneizar las escalas para evitar que las diferencias en las unidades de medida generen distorciones en el cálculo de los componentes principales. Las siguiente gráfica muestra el efecto de la estandarización (Scale).</p>
<div class="figure">
<img src="/img/v.jpg" />

</div>
<p>El proceso de estandarización permite obtener una matriz escalada:</p>
<p><span class="math inline">\(B=\begin{bmatrix}\vec{x}_1-\vec{\mu}|\ldots|\vec{x}_n-\vec{\mu}\end{bmatrix}\)</span></p>
<p>Ahora estimamos la matriz de covarianza <strong>S</strong> que se define como <span class="math display">\[\displaystyle S=\frac{1}{n-1}BB^T\]</span></p>
<p>De la discusión previa podemos ver que S es una matriz simétrica mxm.</p>
<p>Consideremos como ejemplo: <span class="math display">\[\vec{x}_1=\begin{bmatrix}a_1\\a_2\\a_3\end{bmatrix}, \vec{x}_2=\begin{bmatrix}b_1\\b_2\\b_3\end{bmatrix}, \vec{x}_3=\begin{bmatrix}c_1\\c_2\\c_3\end{bmatrix}, \vec{\mu}=\begin{bmatrix}\mu_1\\\mu_2\\\mu_3\end{bmatrix}\]</span> Con matriz escalada <strong>B</strong>: <span class="math display">\[B=\begin{bmatrix}a_1-\mu_1&amp;b_1-\mu_1&amp;c_1-\mu_1\\a_2-\mu_2&amp;b_2-\mu_2&amp;c_2-\mu_2\\a_3-\mu_3&amp;b_3-\mu_3&amp;c_3-\mu_3\end{bmatrix}\]</span> Ahora veamos los elementos de la matriz de covarianza <strong>S</strong></p>
<p><span class="math display">\[\displaystyle S_{11}=\frac{1}{n-1}((a_1-\mu_1)^2+(b_1-\mu_1)^2+(c_1-\mu_1)^2)=\mbox{ Varianza de la primera variable }\]</span> De manera similar los elementos <span class="math inline">\(S_{22}, S_{33}\)</span> representan la varianza de la segunda y tercera variables respectivamente.</p>
<p>En seguida tenemos la covarianza entre la primera y segunda variables:</p>
<p><span class="math display">\[\displaystyle S_{12}=\frac{1}{n-1}((a_1-\mu_1)(a_2-\mu_2)+(b_1-\mu_1)(b_2-\mu_2)+(c_1-\mu_1)(c_2-\mu_2))=S_{21}\]</span> Y generalizando tenemos que:</p>
<ul>
<li><p><span class="math inline">\(S_{ii}\)</span> es la <em>varianza</em> de la <span class="math inline">\(i_{esima}\)</span> variable.</p></li>
<li><p><span class="math inline">\(S_{ij}\)</span> con <span class="math inline">\(i\neq j\)</span> es la covarianza entre las variables i, j.</p></li>
</ul>
<p>El siguiente paso es aplicar el teorema descrito en la sección previa, dado que la matriz <strong>S</strong> es simétrica tendrá Eigenvalores <span class="math inline">\(\lambda_1\geq \lambda_2\geq \ldots\geq\lambda_m\geq 0\)</span> y Eigenvectores ortogonales <span class="math inline">\(\vec{v}_1, \vec{v}_2, \ldots, \vec{v}_m\)</span> Estos vectores son denominados los componentes principales de la base de datos.</p>
<p>Note que el segundo componente principal es una combinación lineal de las variables no correlaciondas con pc1, condición que se deduce de la definición de vectores ortogonales.</p>
<p>Paso siguiente, determiar la varianza total <strong>T</strong> en los datos, que es igual a la <strong>traza</strong><a href="#fn3" class="footnoteRef" id="fnref3"><sup>3</sup></a> de la matriz de <strong>covarianza</strong>.</p>
<p><span class="math display">\[T=\lambda_1+\lambda_2+\ldots+\lambda_m\]</span> ¿Cómo interpretamos los resultados del PCA?</p>
<p>La dirección dada por el vector <span class="math inline">\(\vec{v_{1}}\)</span> <span class="math inline">\(\mathbb{R}^m\)</span> denominado el <strong>primer componente principal</strong> da cuenta de un monto igual a <span class="math inline">\(\lambda_1\)</span> de la varianza total T.</p>
<p>Es una fracción <span class="math inline">\(\displaystyle\frac{\lambda_1}{T}\)</span> de la varianza total. De igual forma, la segunda dirección principal <span class="math inline">\(\vec{v}_2\)</span>, que da cuenta de una fracción <span class="math inline">\(\displaystyle\frac{\lambda_2}{T}\)</span>.</p>
<ul>
<li><p>El vector <span class="math inline">\(\vec{v}_1\in \mathbb{R}^m\)</span> constituye la dirección de mayor importancia en el conjunto de datos.</p></li>
<li><p>Entre las direcciones ortogonales a <span class="math inline">\(\vec{v}_1\)</span>, <span class="math inline">\(\vec{v}_2\)</span> es la dirección más significativa.</p></li>
<li><p>De forma similar entre las direcciones ortogonales a <span class="math inline">\(\vec{v}_1\)</span> y <span class="math inline">\(\vec{v}_2\)</span>, <span class="math inline">\(\vec{v}_3\)</span> es la dirección más significativa y así sucesivamentente.</p></li>
</ul>
<p>¿Que conjunto de datos tenemos como resultado del PCA?</p>
<p>El procedimiento de PCA ha generado una nueva estructura de los datos (reducción en las dimensiones) por lo que ahora podemos representar digamos un espacio vectorial que era digamos <span class="math inline">\(\mathbb{R}^{30}\)</span> mediante una estructura de componentes principales de menor dimensión con las observaciones del conjunto de datos conformando clusters definidos en función de los Eigenvectores.</p>
</div>
<div id="practica." class="section level2">
<h2>Práctica.</h2>
<div id="ejemplo-1-iris.-pca1iris.ipynb" class="section level3">
<h3>Ejemplo 1 Iris. PCA1iris.ipynb</h3>
<p>Ver Jupyter notebook</p>
</div>
<div id="ejemplo-2-hipotetico-200-obs.-pca2.ipynb" class="section level3">
<h3>Ejemplo 2 Hipotético 200 obs. PCA2.ipynb</h3>
<p>Ver Jupyter notebook</p>
</div>
<div id="ejemplo-3-breast-cancer-data-set" class="section level3">
<h3>Ejemplo 3 Breast cáncer data set</h3>
<p>El propósito es determinar un subconjunto de variables que capturen la mayor cantidad de información posible (ej. que capturen la mayor variación posible).</p>
<p>Esta técnica permite además visualizar los vectores a lo largo de los cuales la mayor variación posible es capturada (2D).</p>
<p>Este subconjunto de variables constituyen una síntensis que representa los eigenvectores de la matriz original.</p>
<p><a href="http://archive.ics.uci.edu/ml/datasets/breast+cancer+wisconsin+%28diagnostic%29">Background</a></p>
<pre><code>## &#39;data.frame&#39;:    569 obs. of  33 variables:
##  $ id                     : int  842302 842517 84300903 84348301 84358402 843786 844359 84458202 844981 84501001 ...
##  $ diagnosis              : Factor w/ 2 levels &quot;B&quot;,&quot;M&quot;: 2 2 2 2 2 2 2 2 2 2 ...
##  $ radius_mean            : num  18 20.6 19.7 11.4 20.3 ...
##  $ texture_mean           : num  10.4 17.8 21.2 20.4 14.3 ...
##  $ perimeter_mean         : num  122.8 132.9 130 77.6 135.1 ...
##  $ area_mean              : num  1001 1326 1203 386 1297 ...
##  $ smoothness_mean        : num  0.1184 0.0847 0.1096 0.1425 0.1003 ...
##  $ compactness_mean       : num  0.2776 0.0786 0.1599 0.2839 0.1328 ...
##  $ concavity_mean         : num  0.3001 0.0869 0.1974 0.2414 0.198 ...
##  $ concave.points_mean    : num  0.1471 0.0702 0.1279 0.1052 0.1043 ...
##  $ symmetry_mean          : num  0.242 0.181 0.207 0.26 0.181 ...
##  $ fractal_dimension_mean : num  0.0787 0.0567 0.06 0.0974 0.0588 ...
##  $ radius_se              : num  1.095 0.543 0.746 0.496 0.757 ...
##  $ texture_se             : num  0.905 0.734 0.787 1.156 0.781 ...
##  $ perimeter_se           : num  8.59 3.4 4.58 3.44 5.44 ...
##  $ area_se                : num  153.4 74.1 94 27.2 94.4 ...
##  $ smoothness_se          : num  0.0064 0.00522 0.00615 0.00911 0.01149 ...
##  $ compactness_se         : num  0.049 0.0131 0.0401 0.0746 0.0246 ...
##  $ concavity_se           : num  0.0537 0.0186 0.0383 0.0566 0.0569 ...
##  $ concave.points_se      : num  0.0159 0.0134 0.0206 0.0187 0.0188 ...
##  $ symmetry_se            : num  0.03 0.0139 0.0225 0.0596 0.0176 ...
##  $ fractal_dimension_se   : num  0.00619 0.00353 0.00457 0.00921 0.00511 ...
##  $ radius_worst           : num  25.4 25 23.6 14.9 22.5 ...
##  $ texture_worst          : num  17.3 23.4 25.5 26.5 16.7 ...
##  $ perimeter_worst        : num  184.6 158.8 152.5 98.9 152.2 ...
##  $ area_worst             : num  2019 1956 1709 568 1575 ...
##  $ smoothness_worst       : num  0.162 0.124 0.144 0.21 0.137 ...
##  $ compactness_worst      : num  0.666 0.187 0.424 0.866 0.205 ...
##  $ concavity_worst        : num  0.712 0.242 0.45 0.687 0.4 ...
##  $ concave.points_worst   : num  0.265 0.186 0.243 0.258 0.163 ...
##  $ symmetry_worst         : num  0.46 0.275 0.361 0.664 0.236 ...
##  $ fractal_dimension_worst: num  0.1189 0.089 0.0876 0.173 0.0768 ...
##  $ X                      : logi  NA NA NA NA NA NA ...</code></pre>
<pre><code>##  [1] &quot;id&quot;                      &quot;diagnosis&quot;              
##  [3] &quot;radius_mean&quot;             &quot;texture_mean&quot;           
##  [5] &quot;perimeter_mean&quot;          &quot;area_mean&quot;              
##  [7] &quot;smoothness_mean&quot;         &quot;compactness_mean&quot;       
##  [9] &quot;concavity_mean&quot;          &quot;concave.points_mean&quot;    
## [11] &quot;symmetry_mean&quot;           &quot;fractal_dimension_mean&quot; 
## [13] &quot;radius_se&quot;               &quot;texture_se&quot;             
## [15] &quot;perimeter_se&quot;            &quot;area_se&quot;                
## [17] &quot;smoothness_se&quot;           &quot;compactness_se&quot;         
## [19] &quot;concavity_se&quot;            &quot;concave.points_se&quot;      
## [21] &quot;symmetry_se&quot;             &quot;fractal_dimension_se&quot;   
## [23] &quot;radius_worst&quot;            &quot;texture_worst&quot;          
## [25] &quot;perimeter_worst&quot;         &quot;area_worst&quot;             
## [27] &quot;smoothness_worst&quot;        &quot;compactness_worst&quot;      
## [29] &quot;concavity_worst&quot;         &quot;concave.points_worst&quot;   
## [31] &quot;symmetry_worst&quot;          &quot;fractal_dimension_worst&quot;
## [33] &quot;X&quot;</code></pre>
<p>Observamos que este <strong>df</strong> contine 569 obsrevaciones, en este caso pacientes con diagnóstico de cáncer de mama. Tenemos 30 variables. el df constituye una matriz nxm: 569x30.</p>
<p>Sin embargo, es posible que en las 30 variables tenemos cierta correlación entre ellas. La técnica de <strong>PCA</strong> es útil en este caso por que podemos representar las 30 dimensiones mediante un subconjunto menor que capture la mayor variación posible contenida el la matriz. Esta reducción se basa en la trayectoria de los eigenvectores de la matriz original.</p>
<p>Entre las variables tenemos una denominada diagnosis, esta indica el tipo de tumor benigno <strong>B</strong> o maligno <strong>M</strong>. esta variable es considerada el target para la clasificación posterior, por ejemplo mediante un modelo de regresión logística.</p>
<div id="fase-eda." class="section level4">
<h4>1. Fase EDA.</h4>
<pre><code>##        id            diagnosis  radius_mean      texture_mean  
##  Min.   :     8670   B:357     Min.   : 6.981   Min.   : 9.71  
##  1st Qu.:   869218   M:212     1st Qu.:11.700   1st Qu.:16.17  
##  Median :   906024             Median :13.370   Median :18.84  
##  Mean   : 30371831             Mean   :14.127   Mean   :19.29  
##  3rd Qu.:  8813129             3rd Qu.:15.780   3rd Qu.:21.80  
##  Max.   :911320502             Max.   :28.110   Max.   :39.28  
##  perimeter_mean     area_mean      smoothness_mean   compactness_mean 
##  Min.   : 43.79   Min.   : 143.5   Min.   :0.05263   Min.   :0.01938  
##  1st Qu.: 75.17   1st Qu.: 420.3   1st Qu.:0.08637   1st Qu.:0.06492  
##  Median : 86.24   Median : 551.1   Median :0.09587   Median :0.09263  
##  Mean   : 91.97   Mean   : 654.9   Mean   :0.09636   Mean   :0.10434  
##  3rd Qu.:104.10   3rd Qu.: 782.7   3rd Qu.:0.10530   3rd Qu.:0.13040  
##  Max.   :188.50   Max.   :2501.0   Max.   :0.16340   Max.   :0.34540  
##  concavity_mean    concave.points_mean symmetry_mean   
##  Min.   :0.00000   Min.   :0.00000     Min.   :0.1060  
##  1st Qu.:0.02956   1st Qu.:0.02031     1st Qu.:0.1619  
##  Median :0.06154   Median :0.03350     Median :0.1792  
##  Mean   :0.08880   Mean   :0.04892     Mean   :0.1812  
##  3rd Qu.:0.13070   3rd Qu.:0.07400     3rd Qu.:0.1957  
##  Max.   :0.42680   Max.   :0.20120     Max.   :0.3040  
##  fractal_dimension_mean   radius_se        texture_se      perimeter_se   
##  Min.   :0.04996        Min.   :0.1115   Min.   :0.3602   Min.   : 0.757  
##  1st Qu.:0.05770        1st Qu.:0.2324   1st Qu.:0.8339   1st Qu.: 1.606  
##  Median :0.06154        Median :0.3242   Median :1.1080   Median : 2.287  
##  Mean   :0.06280        Mean   :0.4052   Mean   :1.2169   Mean   : 2.866  
##  3rd Qu.:0.06612        3rd Qu.:0.4789   3rd Qu.:1.4740   3rd Qu.: 3.357  
##  Max.   :0.09744        Max.   :2.8730   Max.   :4.8850   Max.   :21.980  
##     area_se        smoothness_se      compactness_se      concavity_se    
##  Min.   :  6.802   Min.   :0.001713   Min.   :0.002252   Min.   :0.00000  
##  1st Qu.: 17.850   1st Qu.:0.005169   1st Qu.:0.013080   1st Qu.:0.01509  
##  Median : 24.530   Median :0.006380   Median :0.020450   Median :0.02589  
##  Mean   : 40.337   Mean   :0.007041   Mean   :0.025478   Mean   :0.03189  
##  3rd Qu.: 45.190   3rd Qu.:0.008146   3rd Qu.:0.032450   3rd Qu.:0.04205  
##  Max.   :542.200   Max.   :0.031130   Max.   :0.135400   Max.   :0.39600  
##  concave.points_se   symmetry_se       fractal_dimension_se
##  Min.   :0.000000   Min.   :0.007882   Min.   :0.0008948   
##  1st Qu.:0.007638   1st Qu.:0.015160   1st Qu.:0.0022480   
##  Median :0.010930   Median :0.018730   Median :0.0031870   
##  Mean   :0.011796   Mean   :0.020542   Mean   :0.0037949   
##  3rd Qu.:0.014710   3rd Qu.:0.023480   3rd Qu.:0.0045580   
##  Max.   :0.052790   Max.   :0.078950   Max.   :0.0298400   
##   radius_worst   texture_worst   perimeter_worst    area_worst    
##  Min.   : 7.93   Min.   :12.02   Min.   : 50.41   Min.   : 185.2  
##  1st Qu.:13.01   1st Qu.:21.08   1st Qu.: 84.11   1st Qu.: 515.3  
##  Median :14.97   Median :25.41   Median : 97.66   Median : 686.5  
##  Mean   :16.27   Mean   :25.68   Mean   :107.26   Mean   : 880.6  
##  3rd Qu.:18.79   3rd Qu.:29.72   3rd Qu.:125.40   3rd Qu.:1084.0  
##  Max.   :36.04   Max.   :49.54   Max.   :251.20   Max.   :4254.0  
##  smoothness_worst  compactness_worst concavity_worst  concave.points_worst
##  Min.   :0.07117   Min.   :0.02729   Min.   :0.0000   Min.   :0.00000     
##  1st Qu.:0.11660   1st Qu.:0.14720   1st Qu.:0.1145   1st Qu.:0.06493     
##  Median :0.13130   Median :0.21190   Median :0.2267   Median :0.09993     
##  Mean   :0.13237   Mean   :0.25427   Mean   :0.2722   Mean   :0.11461     
##  3rd Qu.:0.14600   3rd Qu.:0.33910   3rd Qu.:0.3829   3rd Qu.:0.16140     
##  Max.   :0.22260   Max.   :1.05800   Max.   :1.2520   Max.   :0.29100     
##  symmetry_worst   fractal_dimension_worst    X          
##  Min.   :0.1565   Min.   :0.05504         Mode:logical  
##  1st Qu.:0.2504   1st Qu.:0.07146         NA&#39;s:569      
##  Median :0.2822   Median :0.08004                       
##  Mean   :0.2901   Mean   :0.08395                       
##  3rd Qu.:0.3179   3rd Qu.:0.09208                       
##  Max.   :0.6638   Max.   :0.20750</code></pre>
<pre><code>## Warning: funs() is soft deprecated as of dplyr 0.8.0
## please use list() instead
## 
## # Before:
## funs(name = f(.)
## 
## # After: 
## list(name = ~f(.))
## This warning is displayed once per session.</code></pre>
<pre><code>## Warning in var(if (is.vector(x) || is.factor(x)) x else as.double(x), na.rm = na.rm): Calling var(x) on a factor x is deprecated and will become an error.
##   Use something like &#39;all(duplicated(x)[-1L])&#39; to test for a constant vector.</code></pre>
<p><img src="/post/2019-02-24-PCA_files/figure-html/unnamed-chunk-4-1.png" width="672" /> Note el grado de correlación entre las variables de la muestra. Soporte en favor de la decisión de usar la metodología de PCA.</p>
</div>
</div>
<div id="implementacion.-pre-proceso-scaling" class="section level3">
<h3>2. Implementación. Pre proceso (Scaling)</h3>
<p>Una pregunta escencial <strong>previo</strong> a la implementación de <strong>PCA</strong> es si debemos estandarizar (scalar) nuestra matriz. ( variables con media=0, std dev=1).( Z-Score Normalization. <em>Standardization involves rescaling the features such that they have the properties of a standard normal distribution with a mean of zero and a standard deviation of one.</em>)</p>
<p>Nota sobre el proceso de estandarización.</p>
<p><em>We can think of Principle Component Analysis (PCA) as being a prime example of when normalization is important. In PCA we are interested in the components that maximize the variance. If one component (e.g. human height) varies less than another (e.g. weight) because of their respective scales (meters vs. kilos), PCA might determine that the direction of maximal variance more closely corresponds with the ‘weight’ axis, if those features are not scaled. As a change in height of one meter can be considered much more important than the change in weight of one kilogram, this is clearly incorrect.</em></p>
<p>La respuesta es directa, cuando las unidades de medida nos son homogéneas es <strong>necesario</strong> escalar los datos.</p>
<p>Escalar los datos implica utilizar la <strong>matriz de correlación</strong>. Utilizar los datos sin escalar require utilizar la correspondiente <strong>matriz de covarianza</strong>.</p>
<p>De lo contrario los <strong>eigenvectores</strong> resultantes en el proceso de estimación de <strong>PCA</strong> no aportan información consistente.(ej. la importancia de cada variable y sus unidades de medida tendrá un impacto en la organización de los <strong>eigenvectores</strong> resultantes distorsionando la varianza real explicada por cada componente).</p>
<div id="estimacion-de-pca-usando-la-matriz-de-correlacion." class="section level4">
<h4>3. Estimacion de PCA usando la matriz de correlación.</h4>
<pre><code>## Importance of components:
##                           PC1    PC2     PC3     PC4     PC5     PC6
## Standard deviation     3.6444 2.3857 1.67867 1.40735 1.28403 1.09880
## Proportion of Variance 0.4427 0.1897 0.09393 0.06602 0.05496 0.04025
## Cumulative Proportion  0.4427 0.6324 0.72636 0.79239 0.84734 0.88759
##                            PC7     PC8    PC9    PC10   PC11    PC12
## Standard deviation     0.82172 0.69037 0.6457 0.59219 0.5421 0.51104
## Proportion of Variance 0.02251 0.01589 0.0139 0.01169 0.0098 0.00871
## Cumulative Proportion  0.91010 0.92598 0.9399 0.95157 0.9614 0.97007
##                           PC13    PC14    PC15    PC16    PC17    PC18
## Standard deviation     0.49128 0.39624 0.30681 0.28260 0.24372 0.22939
## Proportion of Variance 0.00805 0.00523 0.00314 0.00266 0.00198 0.00175
## Cumulative Proportion  0.97812 0.98335 0.98649 0.98915 0.99113 0.99288
##                           PC19    PC20   PC21    PC22    PC23   PC24
## Standard deviation     0.22244 0.17652 0.1731 0.16565 0.15602 0.1344
## Proportion of Variance 0.00165 0.00104 0.0010 0.00091 0.00081 0.0006
## Cumulative Proportion  0.99453 0.99557 0.9966 0.99749 0.99830 0.9989
##                           PC25    PC26    PC27    PC28    PC29    PC30
## Standard deviation     0.12442 0.09043 0.08307 0.03987 0.02736 0.01153
## Proportion of Variance 0.00052 0.00027 0.00023 0.00005 0.00002 0.00000
## Cumulative Proportion  0.99942 0.99969 0.99992 0.99997 1.00000 1.00000</code></pre>
<pre><code>##  [1] 13.28  5.69  2.82  1.98  1.65  1.21  0.68  0.48  0.42  0.35  0.29
## [12]  0.26  0.24  0.16  0.09  0.08  0.06  0.05  0.05  0.03  0.03  0.03
## [23]  0.02  0.02  0.02  0.01  0.01  0.00  0.00  0.00</code></pre>
<pre><code>##  [1] 1.328161e+01 5.691355e+00 2.817949e+00 1.980640e+00 1.648731e+00
##  [6] 1.207357e+00 6.752201e-01 4.766171e-01 4.168948e-01 3.506935e-01
## [11] 2.939157e-01 2.611614e-01 2.413575e-01 1.570097e-01 9.413497e-02
## [16] 7.986280e-02 5.939904e-02 5.261878e-02 4.947759e-02 3.115940e-02
## [21] 2.997289e-02 2.743940e-02 2.434084e-02 1.805501e-02 1.548127e-02
## [26] 8.177640e-03 6.900464e-03 1.589338e-03 7.488031e-04 1.330448e-04</code></pre>
<pre><code>##  [1] 0.44 0.19 0.09 0.07 0.05 0.04 0.02 0.02 0.01 0.01 0.01 0.01 0.01 0.01
## [15] 0.00 0.00 0.00 0.00 0.00 0.00 0.00 0.00 0.00 0.00 0.00 0.00 0.00 0.00
## [29] 0.00 0.00</code></pre>
<pre><code>##  [1] 0.44 0.63 0.73 0.79 0.85 0.89 0.91 0.93 0.94 0.95 0.96 0.97 0.98 0.98
## [15] 0.99 0.99 0.99 0.99 0.99 1.00 1.00 1.00 1.00 1.00 1.00 1.00 1.00 1.00
## [29] 1.00 1.00</code></pre>
<p>El 89% de la varianza es explicada por los primeros 6 componentes. Adicionalmente vemos que eigenvalores&gt;1 para los 6 pc que explican el 89% de la varianza. Este será el criterio de selección para retenter en este caso los pc (ej . si los eigenvalores&gt;1).</p>
<p>Scree plot para mostrar la varianza explicada por cada componente.</p>
<p><img src="/post/2019-02-24-PCA_files/figure-html/unnamed-chunk-7-1.png" width="672" /></p>
<p><img src="/post/2019-02-24-PCA_files/figure-html/unnamed-chunk-8-1.png" width="672" /></p>
</div>
<div id="visualizacion-de-los-datos.-plot-de-observaciones-para-componentes-1-y-2." class="section level4">
<h4>Visualización de los datos. Plot de Observaciones para componentes 1 y 2.</h4>
<p><img src="/post/2019-02-24-PCA_files/figure-html/unnamed-chunk-9-1.png" width="672" /></p>
</div>
<div id="aproximacion-a-la-solucion-del-problema-como-un-escenario-de-supervised-learning." class="section level4">
<h4>Aproximación a la solución del problema como un escenario de <em>supervised learning</em>.</h4>
<p>La variable que nos interesa predecir es <em>diagnosis</em>, ej. determinar si el tumor es maligno o benigno (variable dependiente) con base en las 30 variables independientes.</p>
<p>Primero aplicamos el PCA para reducir las dimensiones del df. esto nos permite clasificar a los pacientes con base en los atributos y visualizar el resultado mendiante un menor número de dimensiones. Get jupyter notebook para mayor referencia sobre el caso de estudio en:</p>
<p><a href="https://www.kaggle.com/shravank/predicting-breast-cancer-using-pca-lda-in-r" class="uri">https://www.kaggle.com/shravank/predicting-breast-cancer-using-pca-lda-in-r</a></p>
</div>
</div>
<div id="ejemplo-4-calificaciones-de-posgrado." class="section level3">
<h3>Ejemplo 4 Calificaciones de posgrado.</h3>
<p>En el siguiente ejemplo considere un conjunto de calificaciones para alumnos de posgrado en dos asignaturas. El objetivo es: a) obtener los componentes principales y eigenvalores b) determinar la proporción de la varianza que explican c) representar los eigenvectores graficamente.</p>
<p>La base de datos contiene 100 observaciones correspondientes a calificaciones en las asignaturas de historia y geografía. La matriz conformada por los datos tiene dimensiones 100x2.</p>
<p>En este ejemplo la intención es enfatizar la estructura conceptual del algoritmo PCA. Note que ya de hecho se tiene 2 dimensiones que facilmente permiten tener una aproximación visual al comportamiento y correlación de los datos, no obstante, la aplicación de PCA permite reforzar los conceptos involucrados en la estimación del algoritmo.</p>
</div>
<div id="leemos-la-base-de-datos." class="section level3">
<h3>1. Leemos la base de datos.</h3>
<pre><code>## [1] &quot;C:/Users/LENOVO/Desktop/DESK/web/MEP-statistics/content/post&quot;</code></pre>
<pre><code>## [1] &quot;historia&quot;  &quot;geografía&quot;</code></pre>
<pre><code>## &#39;data.frame&#39;:    100 obs. of  2 variables:
##  $ historia : num  45.8 66.2 54.8 52.7 55.2 ...
##  $ geografía: num  49.7 64.9 50.5 53 57.5 ...</code></pre>
<pre><code>##   historia geografía
## 1 45.83286  49.73412
## 2 66.24545  64.87357
## 3 54.84116  50.45485
## 4 52.73309  52.98077
## 5 55.22804  57.51052
## 6 36.71771  38.12940</code></pre>
<div id="visualizacion-y-estadisticas-descriptivas." class="section level4">
<h4>1.1 Visualización y estadísticas descriptivas.</h4>
<pre class="r"><code>p&lt;-ggplot(datos, aes(historia,geografía))+
  geom_point(color=&quot;deepskyblue4&quot;, alpha = 0.5)+
  theme_bw()+
  labs(title=&quot;Calificaciones&quot;, x=&quot;Historia (0-100)&quot;, y=&quot;Geografía (0-100)&quot;)

ggplotly(p)</code></pre>
<div id="htmlwidget-1" style="width:672px;height:480px;" class="plotly html-widget"></div>
<script type="application/json" data-for="htmlwidget-1">{"x":{"data":[{"x":[45.83286,66.24545,54.84116,52.73309,55.22804,36.71771,70.60068,46.58481,37.61019,54.4459,42.65069,54.37827,55.48877,54.75712,58.49035,36.50214,57.46308,50.88379,66.00721,40.21083,62.80092,52.6778,46.37766,62.1887,67.25034,46.94243,40.7363,44.16992,63.06225,21.46127,53.06325,46.75746,42.62306,37.1718,35.69836,45.89923,58.04152,54.64092,41.41039,63.12466,41.00973,44.99261,44.93524,37.29267,58.34537,53.43469,45.36934,52.06818,49.16137,51.86147,56.58516,41.69534,62.34281,39.80478,56.0382,44.01542,45.22847,61.32475,45.68322,48.14822,57.17597,46.44202,35.24607,55.56036,41.04521,51.67046,52.93516,35.84404,47.15922,60.08049,55.10556,50.66494,63.17677,49.47325,44.17665,35.61826,47.6078,62.02337,47.17575,59.63255,46.66867,41.92247,58.06207,63.70322,53.54859,54.28997,61.45739,48.42434,47.02817,56.68283,47.39154,53.48607,57.12145,62.14516,52.54617,56.72894,45.37159,29.57351,46.26462,53.3189],"y":[49.73412,64.87357,50.45485,52.98077,57.51052,38.1294,71.31107,43.0755,37.06575,52.86622,48.93422,56.17238,54.14389,54.90254,54.28524,37.7616,56.18982,50.22294,63.74446,40.01258,65.38431,53.11069,44.08331,59.14436,68.91049,46.7534,44.2691,40.07929,61.06836,27.51049,56.62534,44.27409,40.81727,38.58767,30.63126,43.99144,59.51573,53.74517,36.76394,62.46416,40.00774,46.69961,46.71632,37.14477,55.47421,55.79567,47.71729,46.96069,50.08758,56.27546,55.46879,41.89212,62.01932,38.39744,57.49428,44.95353,45.33766,61.32643,47.66341,47.1341,57.60514,41.33925,35.90807,49.76122,45.28572,50.16363,49.51824,33.17955,44.82814,61.18417,54.57818,46.00166,60.00211,51.27673,51.33226,37.75184,49.91266,64.34087,49.49582,54.04946,47.50897,43.92537,59.25163,63.36367,54.65436,52.04134,62.29298,49.98111,48.76383,54.01947,49.38044,51.11642,52.61662,59.79395,47.44484,56.57045,43.3991,35.60014,41.10685,48.86226],"text":["historia: 45.83286<br />geografía: 49.73412","historia: 66.24545<br />geografía: 64.87357","historia: 54.84116<br />geografía: 50.45485","historia: 52.73309<br />geografía: 52.98077","historia: 55.22804<br />geografía: 57.51052","historia: 36.71771<br />geografía: 38.12940","historia: 70.60068<br />geografía: 71.31107","historia: 46.58481<br />geografía: 43.07550","historia: 37.61019<br />geografía: 37.06575","historia: 54.44590<br />geografía: 52.86622","historia: 42.65069<br />geografía: 48.93422","historia: 54.37827<br />geografía: 56.17238","historia: 55.48877<br />geografía: 54.14389","historia: 54.75712<br />geografía: 54.90254","historia: 58.49035<br />geografía: 54.28524","historia: 36.50214<br />geografía: 37.76160","historia: 57.46308<br />geografía: 56.18982","historia: 50.88379<br />geografía: 50.22294","historia: 66.00721<br />geografía: 63.74446","historia: 40.21083<br />geografía: 40.01258","historia: 62.80092<br />geografía: 65.38431","historia: 52.67780<br />geografía: 53.11069","historia: 46.37766<br />geografía: 44.08331","historia: 62.18870<br />geografía: 59.14436","historia: 67.25034<br />geografía: 68.91049","historia: 46.94243<br />geografía: 46.75340","historia: 40.73630<br />geografía: 44.26910","historia: 44.16992<br />geografía: 40.07929","historia: 63.06225<br />geografía: 61.06836","historia: 21.46127<br />geografía: 27.51049","historia: 53.06325<br />geografía: 56.62534","historia: 46.75746<br />geografía: 44.27409","historia: 42.62306<br />geografía: 40.81727","historia: 37.17180<br />geografía: 38.58767","historia: 35.69836<br />geografía: 30.63126","historia: 45.89923<br />geografía: 43.99144","historia: 58.04152<br />geografía: 59.51573","historia: 54.64092<br />geografía: 53.74517","historia: 41.41039<br />geografía: 36.76394","historia: 63.12466<br />geografía: 62.46416","historia: 41.00973<br />geografía: 40.00774","historia: 44.99261<br />geografía: 46.69961","historia: 44.93524<br />geografía: 46.71632","historia: 37.29267<br />geografía: 37.14477","historia: 58.34537<br />geografía: 55.47421","historia: 53.43469<br />geografía: 55.79567","historia: 45.36934<br />geografía: 47.71729","historia: 52.06818<br />geografía: 46.96069","historia: 49.16137<br />geografía: 50.08758","historia: 51.86147<br />geografía: 56.27546","historia: 56.58516<br />geografía: 55.46879","historia: 41.69534<br />geografía: 41.89212","historia: 62.34281<br />geografía: 62.01932","historia: 39.80478<br />geografía: 38.39744","historia: 56.03820<br />geografía: 57.49428","historia: 44.01542<br />geografía: 44.95353","historia: 45.22847<br />geografía: 45.33766","historia: 61.32475<br />geografía: 61.32643","historia: 45.68322<br />geografía: 47.66341","historia: 48.14822<br />geografía: 47.13410","historia: 57.17597<br />geografía: 57.60514","historia: 46.44202<br />geografía: 41.33925","historia: 35.24607<br />geografía: 35.90807","historia: 55.56036<br />geografía: 49.76122","historia: 41.04521<br />geografía: 45.28572","historia: 51.67046<br />geografía: 50.16363","historia: 52.93516<br />geografía: 49.51824","historia: 35.84404<br />geografía: 33.17955","historia: 47.15922<br />geografía: 44.82814","historia: 60.08049<br />geografía: 61.18417","historia: 55.10556<br />geografía: 54.57818","historia: 50.66494<br />geografía: 46.00166","historia: 63.17677<br />geografía: 60.00211","historia: 49.47325<br />geografía: 51.27673","historia: 44.17665<br />geografía: 51.33226","historia: 35.61826<br />geografía: 37.75184","historia: 47.60780<br />geografía: 49.91266","historia: 62.02337<br />geografía: 64.34087","historia: 47.17575<br />geografía: 49.49582","historia: 59.63255<br />geografía: 54.04946","historia: 46.66867<br />geografía: 47.50897","historia: 41.92247<br />geografía: 43.92537","historia: 58.06207<br />geografía: 59.25163","historia: 63.70322<br />geografía: 63.36367","historia: 53.54859<br />geografía: 54.65436","historia: 54.28997<br />geografía: 52.04134","historia: 61.45739<br />geografía: 62.29298","historia: 48.42434<br />geografía: 49.98111","historia: 47.02817<br />geografía: 48.76383","historia: 56.68283<br />geografía: 54.01947","historia: 47.39154<br />geografía: 49.38044","historia: 53.48607<br />geografía: 51.11642","historia: 57.12145<br />geografía: 52.61662","historia: 62.14516<br />geografía: 59.79395","historia: 52.54617<br />geografía: 47.44484","historia: 56.72894<br />geografía: 56.57045","historia: 45.37159<br />geografía: 43.39910","historia: 29.57351<br />geografía: 35.60014","historia: 46.26462<br />geografía: 41.10685","historia: 53.31890<br />geografía: 48.86226"],"type":"scatter","mode":"markers","marker":{"autocolorscale":false,"color":"rgba(0,104,139,1)","opacity":0.5,"size":5.66929133858268,"symbol":"circle","line":{"width":1.88976377952756,"color":"rgba(0,104,139,1)"}},"hoveron":"points","showlegend":false,"xaxis":"x","yaxis":"y","hoverinfo":"text","frame":null}],"layout":{"margin":{"t":43.7625570776256,"r":7.30593607305936,"b":40.1826484018265,"l":37.2602739726027},"plot_bgcolor":"rgba(255,255,255,1)","paper_bgcolor":"rgba(255,255,255,1)","font":{"color":"rgba(0,0,0,1)","family":"","size":14.6118721461187},"title":"Calificaciones","titlefont":{"color":"rgba(0,0,0,1)","family":"","size":17.5342465753425},"xaxis":{"domain":[0,1],"automargin":true,"type":"linear","autorange":false,"range":[19.0042995,73.0576505],"tickmode":"array","ticktext":["20","30","40","50","60","70"],"tickvals":[20,30,40,50,60,70],"categoryorder":"array","categoryarray":["20","30","40","50","60","70"],"nticks":null,"ticks":"outside","tickcolor":"rgba(51,51,51,1)","ticklen":3.65296803652968,"tickwidth":0.66417600664176,"showticklabels":true,"tickfont":{"color":"rgba(77,77,77,1)","family":"","size":11.689497716895},"tickangle":-0,"showline":false,"linecolor":null,"linewidth":0,"showgrid":true,"gridcolor":"rgba(235,235,235,1)","gridwidth":0.66417600664176,"zeroline":false,"anchor":"y","title":"Historia (0-100)","titlefont":{"color":"rgba(0,0,0,1)","family":"","size":14.6118721461187},"hoverformat":".2f"},"yaxis":{"domain":[0,1],"automargin":true,"type":"linear","autorange":false,"range":[25.320461,73.501099],"tickmode":"array","ticktext":["30","40","50","60","70"],"tickvals":[30,40,50,60,70],"categoryorder":"array","categoryarray":["30","40","50","60","70"],"nticks":null,"ticks":"outside","tickcolor":"rgba(51,51,51,1)","ticklen":3.65296803652968,"tickwidth":0.66417600664176,"showticklabels":true,"tickfont":{"color":"rgba(77,77,77,1)","family":"","size":11.689497716895},"tickangle":-0,"showline":false,"linecolor":null,"linewidth":0,"showgrid":true,"gridcolor":"rgba(235,235,235,1)","gridwidth":0.66417600664176,"zeroline":false,"anchor":"x","title":"Geografía (0-100)","titlefont":{"color":"rgba(0,0,0,1)","family":"","size":14.6118721461187},"hoverformat":".2f"},"shapes":[{"type":"rect","fillcolor":"transparent","line":{"color":"rgba(51,51,51,1)","width":0.66417600664176,"linetype":"solid"},"yref":"paper","xref":"paper","x0":0,"x1":1,"y0":0,"y1":1}],"showlegend":false,"legend":{"bgcolor":"rgba(255,255,255,1)","bordercolor":"transparent","borderwidth":1.88976377952756,"font":{"color":"rgba(0,0,0,1)","family":"","size":11.689497716895}},"hovermode":"closest","barmode":"relative"},"config":{"doubleClick":"reset","modeBarButtonsToAdd":[{"name":"Collaborate","icon":{"width":1000,"ascent":500,"descent":-50,"path":"M487 375c7-10 9-23 5-36l-79-259c-3-12-11-23-22-31-11-8-22-12-35-12l-263 0c-15 0-29 5-43 15-13 10-23 23-28 37-5 13-5 25-1 37 0 0 0 3 1 7 1 5 1 8 1 11 0 2 0 4-1 6 0 3-1 5-1 6 1 2 2 4 3 6 1 2 2 4 4 6 2 3 4 5 5 7 5 7 9 16 13 26 4 10 7 19 9 26 0 2 0 5 0 9-1 4-1 6 0 8 0 2 2 5 4 8 3 3 5 5 5 7 4 6 8 15 12 26 4 11 7 19 7 26 1 1 0 4 0 9-1 4-1 7 0 8 1 2 3 5 6 8 4 4 6 6 6 7 4 5 8 13 13 24 4 11 7 20 7 28 1 1 0 4 0 7-1 3-1 6-1 7 0 2 1 4 3 6 1 1 3 4 5 6 2 3 3 5 5 6 1 2 3 5 4 9 2 3 3 7 5 10 1 3 2 6 4 10 2 4 4 7 6 9 2 3 4 5 7 7 3 2 7 3 11 3 3 0 8 0 13-1l0-1c7 2 12 2 14 2l218 0c14 0 25-5 32-16 8-10 10-23 6-37l-79-259c-7-22-13-37-20-43-7-7-19-10-37-10l-248 0c-5 0-9-2-11-5-2-3-2-7 0-12 4-13 18-20 41-20l264 0c5 0 10 2 16 5 5 3 8 6 10 11l85 282c2 5 2 10 2 17 7-3 13-7 17-13z m-304 0c-1-3-1-5 0-7 1-1 3-2 6-2l174 0c2 0 4 1 7 2 2 2 4 4 5 7l6 18c0 3 0 5-1 7-1 1-3 2-6 2l-173 0c-3 0-5-1-8-2-2-2-4-4-4-7z m-24-73c-1-3-1-5 0-7 2-2 3-2 6-2l174 0c2 0 5 0 7 2 3 2 4 4 5 7l6 18c1 2 0 5-1 6-1 2-3 3-5 3l-174 0c-3 0-5-1-7-3-3-1-4-4-5-6z"},"click":"function(gd) { \n        // is this being viewed in RStudio?\n        if (location.search == '?viewer_pane=1') {\n          alert('To learn about plotly for collaboration, visit:\\n https://cpsievert.github.io/plotly_book/plot-ly-for-collaboration.html');\n        } else {\n          window.open('https://cpsievert.github.io/plotly_book/plot-ly-for-collaboration.html', '_blank');\n        }\n      }"}],"cloud":false},"source":"A","attrs":{"a46f5d5a31":{"x":{},"y":{},"type":"scatter"}},"cur_data":"a46f5d5a31","visdat":{"a46f5d5a31":["function (y) ","x"]},"highlight":{"on":"plotly_click","persistent":false,"dynamic":false,"selectize":false,"opacityDim":0.2,"selected":{"opacity":1},"debounce":0},"base_url":"https://plot.ly"},"evals":["config.modeBarButtonsToAdd.0.click"],"jsHooks":[]}</script>
<pre class="r"><code>summary(datos)</code></pre>
<pre><code>##     historia       geografía    
##  Min.   :21.46   Min.   :27.51  
##  1st Qu.:44.98   1st Qu.:44.22  
##  Median :51.28   Median :49.95  
##  Mean   :50.37   Mean   :50.06  
##  3rd Qu.:56.69   3rd Qu.:56.18  
##  Max.   :70.60   Max.   :71.31</code></pre>
<pre class="r"><code>d &lt;- mutate(datos,mh=mean(historia), mg=mean(geografía),historia=historia-mh,geografía=geografía-mg)%&gt;%
  select(-c(mh,mg))

plt&lt;-ggplot(d,aes(historia,geografía))+
  geom_point()+
  geom_point(color=&quot;red&quot;, alpha = 0.5)+
  theme_bw()+
  labs(title=&quot;Calificaciones (Escala 0-100)&quot;, x=&quot;Historia&quot;, y=&quot;Geografía &quot;)+
  xlim(c(-30,30))

ggplotly(plt)</code></pre>
<div id="htmlwidget-2" style="width:672px;height:480px;" class="plotly html-widget"></div>
<script type="application/json" data-for="htmlwidget-2">{"x":{"data":[{"x":[-4.53370990000001,15.8788801,4.4745901,2.3665201,4.8614701,-13.6488599,20.2341101,-3.7817599,-12.7563799,4.0793301,-7.7158799,4.0117001,5.1222001,4.3905501,8.1237801,-13.8644299,7.0965101,0.517220099999996,15.6406401,-10.1557399,12.4343501,2.3112301,-3.9889099,11.8221301,16.8837701,-3.4241399,-9.6302699,-6.1966499,12.6956801,-28.9052999,2.69668009999999,-3.6091099,-7.7435099,-13.1947699,-14.6682099,-4.4673399,7.6749501,4.2743501,-8.9561799,12.7580901,-9.3568399,-5.3739599,-5.4313299,-13.0738999,7.9788001,3.0681201,-4.9972299,1.7016101,-1.2051999,1.4949001,6.2185901,-8.6712299,11.9762401,-10.5617899,5.6716301,-6.3511499,-5.1380999,10.9581801,-4.6833499,-2.2183499,6.8094001,-3.9245499,-15.1204999,5.1937901,-9.3213599,1.3038901,2.5685901,-14.5225299,-3.2073499,9.7139201,4.7389901,0.2983701,12.8102001,-0.893319900000002,-6.1899199,-14.7483099,-2.7587699,11.6568001,-3.1908199,9.2659801,-3.6978999,-8.4440999,7.6955001,13.3366501,3.1820201,3.92340009999999,11.0908201,-1.9422299,-3.3383999,6.3162601,-2.9750299,3.1195001,6.7548801,11.7785901,2.17960009999999,6.3623701,-4.9949799,-20.7930599,-4.1019499,2.9523301],"y":[-0.324642500000003,14.8148075,0.3960875,2.9220075,7.4517575,-11.9293625,21.2523075,-6.9832625,-12.9930125,2.8074575,-1.1245425,6.1136175,4.0851275,4.8437775,4.2264775,-12.2971625,6.1310575,0.164177500000001,13.6856975,-10.0461825,15.3255475,3.0519275,-5.9754525,9.0855975,18.8517275,-3.3053625,-5.7896625,-9.9794725,11.0095975,-22.5482725,6.5665775,-5.7846725,-9.2414925,-11.4710925,-19.4275025,-6.0673225,9.4569675,3.6864075,-13.2948225,12.4053975,-10.0510225,-3.3591525,-3.3424425,-12.9139925,5.4154475,5.7369075,-2.3414725,-3.0980725,0.0288175000000024,6.2166975,5.4100275,-8.1666425,11.9605575,-11.6613225,7.4355175,-5.1052325,-4.7211025,11.2676675,-2.3953525,-2.9246625,7.5463775,-8.7195125,-14.1506925,-0.297542499999999,-4.7730425,0.104867499999997,-0.540522500000002,-16.8792125,-5.2306225,11.1254075,4.5194175,-4.0571025,9.9433475,1.2179675,1.2734975,-12.3069225,-0.146102499999998,14.2821075,-0.562942499999998,3.9906975,-2.5497925,-6.1333925,9.1928675,13.3049075,4.5955975,1.9825775,12.2342175,-0.0776524999999992,-1.2949325,3.9607075,-0.6783225,1.0576575,2.5578575,9.7351875,-2.6139225,6.5116875,-6.6596625,-14.4586225,-8.9519125,-1.1965025],"text":["historia:  -4.5337099<br />geografía:  -0.3246425","historia:  15.8788801<br />geografía:  14.8148075","historia:   4.4745901<br />geografía:   0.3960875","historia:   2.3665201<br />geografía:   2.9220075","historia:   4.8614701<br />geografía:   7.4517575","historia: -13.6488599<br />geografía: -11.9293625","historia:  20.2341101<br />geografía:  21.2523075","historia:  -3.7817599<br />geografía:  -6.9832625","historia: -12.7563799<br />geografía: -12.9930125","historia:   4.0793301<br />geografía:   2.8074575","historia:  -7.7158799<br />geografía:  -1.1245425","historia:   4.0117001<br />geografía:   6.1136175","historia:   5.1222001<br />geografía:   4.0851275","historia:   4.3905501<br />geografía:   4.8437775","historia:   8.1237801<br />geografía:   4.2264775","historia: -13.8644299<br />geografía: -12.2971625","historia:   7.0965101<br />geografía:   6.1310575","historia:   0.5172201<br />geografía:   0.1641775","historia:  15.6406401<br />geografía:  13.6856975","historia: -10.1557399<br />geografía: -10.0461825","historia:  12.4343501<br />geografía:  15.3255475","historia:   2.3112301<br />geografía:   3.0519275","historia:  -3.9889099<br />geografía:  -5.9754525","historia:  11.8221301<br />geografía:   9.0855975","historia:  16.8837701<br />geografía:  18.8517275","historia:  -3.4241399<br />geografía:  -3.3053625","historia:  -9.6302699<br />geografía:  -5.7896625","historia:  -6.1966499<br />geografía:  -9.9794725","historia:  12.6956801<br />geografía:  11.0095975","historia: -28.9052999<br />geografía: -22.5482725","historia:   2.6966801<br />geografía:   6.5665775","historia:  -3.6091099<br />geografía:  -5.7846725","historia:  -7.7435099<br />geografía:  -9.2414925","historia: -13.1947699<br />geografía: -11.4710925","historia: -14.6682099<br />geografía: -19.4275025","historia:  -4.4673399<br />geografía:  -6.0673225","historia:   7.6749501<br />geografía:   9.4569675","historia:   4.2743501<br />geografía:   3.6864075","historia:  -8.9561799<br />geografía: -13.2948225","historia:  12.7580901<br />geografía:  12.4053975","historia:  -9.3568399<br />geografía: -10.0510225","historia:  -5.3739599<br />geografía:  -3.3591525","historia:  -5.4313299<br />geografía:  -3.3424425","historia: -13.0738999<br />geografía: -12.9139925","historia:   7.9788001<br />geografía:   5.4154475","historia:   3.0681201<br />geografía:   5.7369075","historia:  -4.9972299<br />geografía:  -2.3414725","historia:   1.7016101<br />geografía:  -3.0980725","historia:  -1.2051999<br />geografía:   0.0288175","historia:   1.4949001<br />geografía:   6.2166975","historia:   6.2185901<br />geografía:   5.4100275","historia:  -8.6712299<br />geografía:  -8.1666425","historia:  11.9762401<br />geografía:  11.9605575","historia: -10.5617899<br />geografía: -11.6613225","historia:   5.6716301<br />geografía:   7.4355175","historia:  -6.3511499<br />geografía:  -5.1052325","historia:  -5.1380999<br />geografía:  -4.7211025","historia:  10.9581801<br />geografía:  11.2676675","historia:  -4.6833499<br />geografía:  -2.3953525","historia:  -2.2183499<br />geografía:  -2.9246625","historia:   6.8094001<br />geografía:   7.5463775","historia:  -3.9245499<br />geografía:  -8.7195125","historia: -15.1204999<br />geografía: -14.1506925","historia:   5.1937901<br />geografía:  -0.2975425","historia:  -9.3213599<br />geografía:  -4.7730425","historia:   1.3038901<br />geografía:   0.1048675","historia:   2.5685901<br />geografía:  -0.5405225","historia: -14.5225299<br />geografía: -16.8792125","historia:  -3.2073499<br />geografía:  -5.2306225","historia:   9.7139201<br />geografía:  11.1254075","historia:   4.7389901<br />geografía:   4.5194175","historia:   0.2983701<br />geografía:  -4.0571025","historia:  12.8102001<br />geografía:   9.9433475","historia:  -0.8933199<br />geografía:   1.2179675","historia:  -6.1899199<br />geografía:   1.2734975","historia: -14.7483099<br />geografía: -12.3069225","historia:  -2.7587699<br />geografía:  -0.1461025","historia:  11.6568001<br />geografía:  14.2821075","historia:  -3.1908199<br />geografía:  -0.5629425","historia:   9.2659801<br />geografía:   3.9906975","historia:  -3.6978999<br />geografía:  -2.5497925","historia:  -8.4440999<br />geografía:  -6.1333925","historia:   7.6955001<br />geografía:   9.1928675","historia:  13.3366501<br />geografía:  13.3049075","historia:   3.1820201<br />geografía:   4.5955975","historia:   3.9234001<br />geografía:   1.9825775","historia:  11.0908201<br />geografía:  12.2342175","historia:  -1.9422299<br />geografía:  -0.0776525","historia:  -3.3383999<br />geografía:  -1.2949325","historia:   6.3162601<br />geografía:   3.9607075","historia:  -2.9750299<br />geografía:  -0.6783225","historia:   3.1195001<br />geografía:   1.0576575","historia:   6.7548801<br />geografía:   2.5578575","historia:  11.7785901<br />geografía:   9.7351875","historia:   2.1796001<br />geografía:  -2.6139225","historia:   6.3623701<br />geografía:   6.5116875","historia:  -4.9949799<br />geografía:  -6.6596625","historia: -20.7930599<br />geografía: -14.4586225","historia:  -4.1019499<br />geografía:  -8.9519125","historia:   2.9523301<br />geografía:  -1.1965025"],"type":"scatter","mode":"markers","marker":{"autocolorscale":false,"color":"rgba(255,0,0,1)","opacity":0.5,"size":5.66929133858268,"symbol":"circle","line":{"width":1.88976377952756,"color":"rgba(255,0,0,1)"}},"hoveron":"points","showlegend":false,"xaxis":"x","yaxis":"y","hoverinfo":"text","frame":null}],"layout":{"margin":{"t":43.7625570776256,"r":7.30593607305936,"b":40.1826484018265,"l":43.1050228310502},"plot_bgcolor":"rgba(255,255,255,1)","paper_bgcolor":"rgba(255,255,255,1)","font":{"color":"rgba(0,0,0,1)","family":"","size":14.6118721461187},"title":"Calificaciones (Escala 0-100)","titlefont":{"color":"rgba(0,0,0,1)","family":"","size":17.5342465753425},"xaxis":{"domain":[0,1],"automargin":true,"type":"linear","autorange":false,"range":[-33,33],"tickmode":"array","ticktext":["-20","0","20"],"tickvals":[-20,0,20],"categoryorder":"array","categoryarray":["-20","0","20"],"nticks":null,"ticks":"outside","tickcolor":"rgba(51,51,51,1)","ticklen":3.65296803652968,"tickwidth":0.66417600664176,"showticklabels":true,"tickfont":{"color":"rgba(77,77,77,1)","family":"","size":11.689497716895},"tickangle":-0,"showline":false,"linecolor":null,"linewidth":0,"showgrid":true,"gridcolor":"rgba(235,235,235,1)","gridwidth":0.66417600664176,"zeroline":false,"anchor":"y","title":"Historia","titlefont":{"color":"rgba(0,0,0,1)","family":"","size":14.6118721461187},"hoverformat":".2f"},"yaxis":{"domain":[0,1],"automargin":true,"type":"linear","autorange":false,"range":[-24.7383015,23.4423365],"tickmode":"array","ticktext":["-20","-10","0","10","20"],"tickvals":[-20,-10,-3.5527136788005e-015,10,20],"categoryorder":"array","categoryarray":["-20","-10","0","10","20"],"nticks":null,"ticks":"outside","tickcolor":"rgba(51,51,51,1)","ticklen":3.65296803652968,"tickwidth":0.66417600664176,"showticklabels":true,"tickfont":{"color":"rgba(77,77,77,1)","family":"","size":11.689497716895},"tickangle":-0,"showline":false,"linecolor":null,"linewidth":0,"showgrid":true,"gridcolor":"rgba(235,235,235,1)","gridwidth":0.66417600664176,"zeroline":false,"anchor":"x","title":"Geografía ","titlefont":{"color":"rgba(0,0,0,1)","family":"","size":14.6118721461187},"hoverformat":".2f"},"shapes":[{"type":"rect","fillcolor":"transparent","line":{"color":"rgba(51,51,51,1)","width":0.66417600664176,"linetype":"solid"},"yref":"paper","xref":"paper","x0":0,"x1":1,"y0":0,"y1":1}],"showlegend":false,"legend":{"bgcolor":"rgba(255,255,255,1)","bordercolor":"transparent","borderwidth":1.88976377952756,"font":{"color":"rgba(0,0,0,1)","family":"","size":11.689497716895}},"hovermode":"closest","barmode":"relative"},"config":{"doubleClick":"reset","modeBarButtonsToAdd":[{"name":"Collaborate","icon":{"width":1000,"ascent":500,"descent":-50,"path":"M487 375c7-10 9-23 5-36l-79-259c-3-12-11-23-22-31-11-8-22-12-35-12l-263 0c-15 0-29 5-43 15-13 10-23 23-28 37-5 13-5 25-1 37 0 0 0 3 1 7 1 5 1 8 1 11 0 2 0 4-1 6 0 3-1 5-1 6 1 2 2 4 3 6 1 2 2 4 4 6 2 3 4 5 5 7 5 7 9 16 13 26 4 10 7 19 9 26 0 2 0 5 0 9-1 4-1 6 0 8 0 2 2 5 4 8 3 3 5 5 5 7 4 6 8 15 12 26 4 11 7 19 7 26 1 1 0 4 0 9-1 4-1 7 0 8 1 2 3 5 6 8 4 4 6 6 6 7 4 5 8 13 13 24 4 11 7 20 7 28 1 1 0 4 0 7-1 3-1 6-1 7 0 2 1 4 3 6 1 1 3 4 5 6 2 3 3 5 5 6 1 2 3 5 4 9 2 3 3 7 5 10 1 3 2 6 4 10 2 4 4 7 6 9 2 3 4 5 7 7 3 2 7 3 11 3 3 0 8 0 13-1l0-1c7 2 12 2 14 2l218 0c14 0 25-5 32-16 8-10 10-23 6-37l-79-259c-7-22-13-37-20-43-7-7-19-10-37-10l-248 0c-5 0-9-2-11-5-2-3-2-7 0-12 4-13 18-20 41-20l264 0c5 0 10 2 16 5 5 3 8 6 10 11l85 282c2 5 2 10 2 17 7-3 13-7 17-13z m-304 0c-1-3-1-5 0-7 1-1 3-2 6-2l174 0c2 0 4 1 7 2 2 2 4 4 5 7l6 18c0 3 0 5-1 7-1 1-3 2-6 2l-173 0c-3 0-5-1-8-2-2-2-4-4-4-7z m-24-73c-1-3-1-5 0-7 2-2 3-2 6-2l174 0c2 0 5 0 7 2 3 2 4 4 5 7l6 18c1 2 0 5-1 6-1 2-3 3-5 3l-174 0c-3 0-5-1-7-3-3-1-4-4-5-6z"},"click":"function(gd) { \n        // is this being viewed in RStudio?\n        if (location.search == '?viewer_pane=1') {\n          alert('To learn about plotly for collaboration, visit:\\n https://cpsievert.github.io/plotly_book/plot-ly-for-collaboration.html');\n        } else {\n          window.open('https://cpsievert.github.io/plotly_book/plot-ly-for-collaboration.html', '_blank');\n        }\n      }"}],"cloud":false},"source":"A","attrs":{"a459321f85":{"x":{},"y":{},"type":"scatter"},"a43a834c81":{"x":{},"y":{}}},"cur_data":"a459321f85","visdat":{"a459321f85":["function (y) ","x"],"a43a834c81":["function (y) ","x"]},"highlight":{"on":"plotly_click","persistent":false,"dynamic":false,"selectize":false,"opacityDim":0.2,"selected":{"opacity":1},"debounce":0},"base_url":"https://plot.ly"},"evals":["config.modeBarButtonsToAdd.0.click"],"jsHooks":[]}</script>
</div>
</div>
<div id="determinacion-de-matriz-de-covarianza.-estimacion-de-eigenvectores-cp-y-eigenvalores." class="section level3">
<h3>Determinación de matriz de covarianza. Estimación de eigenvectores (CP) y eigenvalores.</h3>
<pre class="r"><code>mcov &lt;- cov(d)
eigenv &lt;- eigen(mcov)
colnames(eigenv$vectors) &lt;-c(&quot;PC1&quot;,&quot;PC&quot;)
rownames(eigenv$vectors) &lt;- c(&quot;Historia&quot;,&quot;Heografía&quot;)
eigenv</code></pre>
<pre><code>## eigen() decomposition
## $values
## [1] 155.283739   3.972616
## 
## $vectors
##                  PC1         PC
## Historia  -0.7192421  0.6947595
## Heografía -0.6947595 -0.7192421</code></pre>
<pre class="r"><code>pr &lt;- prcomp(d,  center = TRUE)
summary(pr)</code></pre>
<pre><code>## Importance of components:
##                            PC1     PC2
## Standard deviation     12.4613 1.99314
## Proportion of Variance  0.9751 0.02494
## Cumulative Proportion   0.9751 1.00000</code></pre>
<pre class="r"><code>pr</code></pre>
<pre><code>## Standard deviations (1, .., p=2):
## [1] 12.461290  1.993142
## 
## Rotation (n x k) = (2 x 2):
##                 PC1        PC2
## historia  0.7192421  0.6947595
## geografía 0.6947595 -0.7192421</code></pre>
<pre class="r"><code># Hemos obtenido los eigenvalores (Standard deviations^2) y la matrz de eigenvectores  (rotation). 

# Eigenvalores
pr.var &lt;- pr$sdev ^ 2
round(pr.var, 2)</code></pre>
<pre><code>## [1] 155.28   3.97</code></pre>
<pre class="r"><code># Proporción Variance explained by each principal component: pve
pve &lt;- pr.var/sum(pr.var)
round(pve, 2)</code></pre>
<pre><code>## [1] 0.98 0.02</code></pre>
<pre class="r"><code># Acumulado
round(cumsum(pve), 3)</code></pre>
<pre><code>## [1] 0.975 1.000</code></pre>
<p>Note que cada componente principal es una combinación lineal de las variables en los datos. ej. CP1 es una combinación lineal de las variables historia y geografía.</p>
<p>El componente principal 1 captura el <span class="math inline">\(97.5\%\)</span> de la variación de los datos.</p>
<p>Note: El algoritmo PCA aporta la toda la información requerida (eigenvalores std^2 ), eigenvectores (rotation), valores de la matriz original reproyectados con el espacio vectorial de los componentes principales (scores= loadings*datos originales).</p>
<div id="comprobando-que-los-eigenvalores-capturan-varianza-total-en-los-datos." class="section level4">
<h4>Comprobando que los eigenvalores capturan varianza total en los datos.</h4>
<pre class="r"><code>sum(eigenv$values)</code></pre>
<pre><code>## [1] 159.2564</code></pre>
<pre class="r"><code>var(d[,1]) + var(d[,2])</code></pre>
<pre><code>## [1] 159.2564</code></pre>
<div id="graficamos-los-eigenvectores." class="section level5">
<h5>Graficamos los eigenvectores.</h5>
<pre class="r"><code># Representamos cada los eigebvectores

pc1 &lt;- pr$rotation[1,1]/pr$rotation[2,1]
pc2 &lt;- pr$rotation[1,2]/pr$rotation[2,2]


plt&lt;-ggplot(d,aes(historia,geografía))+
  geom_point()+
  geom_point(color=&quot;red&quot;, alpha = 0.5)+
  theme_bw()+
  labs(title=&quot;Calificaciones (Escala 0-100)&quot;, x=&quot;Historia&quot;, y=&quot;Geografía &quot;)+
  xlim(c(-30,30))+
  geom_abline(intercept = 0, slope = pc1, color=&quot;deepskyblue4&quot;)+
  geom_abline(intercept = 0, slope = pc2, color=&quot;orange&quot;)+
  annotate(geom=&quot;text&quot;, x=24, y=11, label=&quot;(-0.710,-0.695)&quot;,
              color=&quot;deepskyblue4&quot;)+
  annotate(geom=&quot;text&quot;, x=-24, y=11, label=&quot;(0.695,-0.719)&quot;,
              color=&quot;orange&quot;)
  
ggplotly(plt)</code></pre>
<p><div id="htmlwidget-3" style="width:672px;height:480px;" class="plotly html-widget"></div>
<script type="application/json" data-for="htmlwidget-3">{"x":{"data":[{"x":[-4.53370990000001,15.8788801,4.4745901,2.3665201,4.8614701,-13.6488599,20.2341101,-3.7817599,-12.7563799,4.0793301,-7.7158799,4.0117001,5.1222001,4.3905501,8.1237801,-13.8644299,7.0965101,0.517220099999996,15.6406401,-10.1557399,12.4343501,2.3112301,-3.9889099,11.8221301,16.8837701,-3.4241399,-9.6302699,-6.1966499,12.6956801,-28.9052999,2.69668009999999,-3.6091099,-7.7435099,-13.1947699,-14.6682099,-4.4673399,7.6749501,4.2743501,-8.9561799,12.7580901,-9.3568399,-5.3739599,-5.4313299,-13.0738999,7.9788001,3.0681201,-4.9972299,1.7016101,-1.2051999,1.4949001,6.2185901,-8.6712299,11.9762401,-10.5617899,5.6716301,-6.3511499,-5.1380999,10.9581801,-4.6833499,-2.2183499,6.8094001,-3.9245499,-15.1204999,5.1937901,-9.3213599,1.3038901,2.5685901,-14.5225299,-3.2073499,9.7139201,4.7389901,0.2983701,12.8102001,-0.893319900000002,-6.1899199,-14.7483099,-2.7587699,11.6568001,-3.1908199,9.2659801,-3.6978999,-8.4440999,7.6955001,13.3366501,3.1820201,3.92340009999999,11.0908201,-1.9422299,-3.3383999,6.3162601,-2.9750299,3.1195001,6.7548801,11.7785901,2.17960009999999,6.3623701,-4.9949799,-20.7930599,-4.1019499,2.9523301],"y":[-0.324642500000003,14.8148075,0.3960875,2.9220075,7.4517575,-11.9293625,21.2523075,-6.9832625,-12.9930125,2.8074575,-1.1245425,6.1136175,4.0851275,4.8437775,4.2264775,-12.2971625,6.1310575,0.164177500000001,13.6856975,-10.0461825,15.3255475,3.0519275,-5.9754525,9.0855975,18.8517275,-3.3053625,-5.7896625,-9.9794725,11.0095975,-22.5482725,6.5665775,-5.7846725,-9.2414925,-11.4710925,-19.4275025,-6.0673225,9.4569675,3.6864075,-13.2948225,12.4053975,-10.0510225,-3.3591525,-3.3424425,-12.9139925,5.4154475,5.7369075,-2.3414725,-3.0980725,0.0288175000000024,6.2166975,5.4100275,-8.1666425,11.9605575,-11.6613225,7.4355175,-5.1052325,-4.7211025,11.2676675,-2.3953525,-2.9246625,7.5463775,-8.7195125,-14.1506925,-0.297542499999999,-4.7730425,0.104867499999997,-0.540522500000002,-16.8792125,-5.2306225,11.1254075,4.5194175,-4.0571025,9.9433475,1.2179675,1.2734975,-12.3069225,-0.146102499999998,14.2821075,-0.562942499999998,3.9906975,-2.5497925,-6.1333925,9.1928675,13.3049075,4.5955975,1.9825775,12.2342175,-0.0776524999999992,-1.2949325,3.9607075,-0.6783225,1.0576575,2.5578575,9.7351875,-2.6139225,6.5116875,-6.6596625,-14.4586225,-8.9519125,-1.1965025],"text":["historia:  -4.5337099<br />geografía:  -0.3246425","historia:  15.8788801<br />geografía:  14.8148075","historia:   4.4745901<br />geografía:   0.3960875","historia:   2.3665201<br />geografía:   2.9220075","historia:   4.8614701<br />geografía:   7.4517575","historia: -13.6488599<br />geografía: -11.9293625","historia:  20.2341101<br />geografía:  21.2523075","historia:  -3.7817599<br />geografía:  -6.9832625","historia: -12.7563799<br />geografía: -12.9930125","historia:   4.0793301<br />geografía:   2.8074575","historia:  -7.7158799<br />geografía:  -1.1245425","historia:   4.0117001<br />geografía:   6.1136175","historia:   5.1222001<br />geografía:   4.0851275","historia:   4.3905501<br />geografía:   4.8437775","historia:   8.1237801<br />geografía:   4.2264775","historia: -13.8644299<br />geografía: -12.2971625","historia:   7.0965101<br />geografía:   6.1310575","historia:   0.5172201<br />geografía:   0.1641775","historia:  15.6406401<br />geografía:  13.6856975","historia: -10.1557399<br />geografía: -10.0461825","historia:  12.4343501<br />geografía:  15.3255475","historia:   2.3112301<br />geografía:   3.0519275","historia:  -3.9889099<br />geografía:  -5.9754525","historia:  11.8221301<br />geografía:   9.0855975","historia:  16.8837701<br />geografía:  18.8517275","historia:  -3.4241399<br />geografía:  -3.3053625","historia:  -9.6302699<br />geografía:  -5.7896625","historia:  -6.1966499<br />geografía:  -9.9794725","historia:  12.6956801<br />geografía:  11.0095975","historia: -28.9052999<br />geografía: -22.5482725","historia:   2.6966801<br />geografía:   6.5665775","historia:  -3.6091099<br />geografía:  -5.7846725","historia:  -7.7435099<br />geografía:  -9.2414925","historia: -13.1947699<br />geografía: -11.4710925","historia: -14.6682099<br />geografía: -19.4275025","historia:  -4.4673399<br />geografía:  -6.0673225","historia:   7.6749501<br />geografía:   9.4569675","historia:   4.2743501<br />geografía:   3.6864075","historia:  -8.9561799<br />geografía: -13.2948225","historia:  12.7580901<br />geografía:  12.4053975","historia:  -9.3568399<br />geografía: -10.0510225","historia:  -5.3739599<br />geografía:  -3.3591525","historia:  -5.4313299<br />geografía:  -3.3424425","historia: -13.0738999<br />geografía: -12.9139925","historia:   7.9788001<br />geografía:   5.4154475","historia:   3.0681201<br />geografía:   5.7369075","historia:  -4.9972299<br />geografía:  -2.3414725","historia:   1.7016101<br />geografía:  -3.0980725","historia:  -1.2051999<br />geografía:   0.0288175","historia:   1.4949001<br />geografía:   6.2166975","historia:   6.2185901<br />geografía:   5.4100275","historia:  -8.6712299<br />geografía:  -8.1666425","historia:  11.9762401<br />geografía:  11.9605575","historia: -10.5617899<br />geografía: -11.6613225","historia:   5.6716301<br />geografía:   7.4355175","historia:  -6.3511499<br />geografía:  -5.1052325","historia:  -5.1380999<br />geografía:  -4.7211025","historia:  10.9581801<br />geografía:  11.2676675","historia:  -4.6833499<br />geografía:  -2.3953525","historia:  -2.2183499<br />geografía:  -2.9246625","historia:   6.8094001<br />geografía:   7.5463775","historia:  -3.9245499<br />geografía:  -8.7195125","historia: -15.1204999<br />geografía: -14.1506925","historia:   5.1937901<br />geografía:  -0.2975425","historia:  -9.3213599<br />geografía:  -4.7730425","historia:   1.3038901<br />geografía:   0.1048675","historia:   2.5685901<br />geografía:  -0.5405225","historia: -14.5225299<br />geografía: -16.8792125","historia:  -3.2073499<br />geografía:  -5.2306225","historia:   9.7139201<br />geografía:  11.1254075","historia:   4.7389901<br />geografía:   4.5194175","historia:   0.2983701<br />geografía:  -4.0571025","historia:  12.8102001<br />geografía:   9.9433475","historia:  -0.8933199<br />geografía:   1.2179675","historia:  -6.1899199<br />geografía:   1.2734975","historia: -14.7483099<br />geografía: -12.3069225","historia:  -2.7587699<br />geografía:  -0.1461025","historia:  11.6568001<br />geografía:  14.2821075","historia:  -3.1908199<br />geografía:  -0.5629425","historia:   9.2659801<br />geografía:   3.9906975","historia:  -3.6978999<br />geografía:  -2.5497925","historia:  -8.4440999<br />geografía:  -6.1333925","historia:   7.6955001<br />geografía:   9.1928675","historia:  13.3366501<br />geografía:  13.3049075","historia:   3.1820201<br />geografía:   4.5955975","historia:   3.9234001<br />geografía:   1.9825775","historia:  11.0908201<br />geografía:  12.2342175","historia:  -1.9422299<br />geografía:  -0.0776525","historia:  -3.3383999<br />geografía:  -1.2949325","historia:   6.3162601<br />geografía:   3.9607075","historia:  -2.9750299<br />geografía:  -0.6783225","historia:   3.1195001<br />geografía:   1.0576575","historia:   6.7548801<br />geografía:   2.5578575","historia:  11.7785901<br />geografía:   9.7351875","historia:   2.1796001<br />geografía:  -2.6139225","historia:   6.3623701<br />geografía:   6.5116875","historia:  -4.9949799<br />geografía:  -6.6596625","historia: -20.7930599<br />geografía: -14.4586225","historia:  -4.1019499<br />geografía:  -8.9519125","historia:   2.9523301<br />geografía:  -1.1965025"],"type":"scatter","mode":"markers","marker":{"autocolorscale":false,"color":"rgba(255,0,0,1)","opacity":0.5,"size":5.66929133858268,"symbol":"circle","line":{"width":1.88976377952756,"color":"rgba(255,0,0,1)"}},"hoveron":"points","showlegend":false,"xaxis":"x","yaxis":"y","hoverinfo":"text","frame":null},{"x":[-33,33],"y":[-34.1628835157893,34.1628835157893],"text":"intercept: 0<br />slope: 1.035239","type":"scatter","mode":"lines","line":{"width":1.88976377952756,"color":"rgba(0,104,139,1)","dash":"solid"},"hoveron":"points","showlegend":false,"xaxis":"x","yaxis":"y","hoverinfo":"text","frame":null},{"x":[-33,33],"y":[31.8767003229305,-31.8767003229305],"text":"intercept: 0<br />slope: -0.9659606","type":"scatter","mode":"lines","line":{"width":1.88976377952756,"color":"rgba(255,165,0,1)","dash":"solid"},"hoveron":"points","showlegend":false,"xaxis":"x","yaxis":"y","hoverinfo":"text","frame":null},{"x":[24],"y":[11],"text":"(-0.710,-0.695)","hovertext":"x: 24<br />y: 11","textfont":{"size":14.6645669291339,"color":"rgba(0,104,139,1)"},"type":"scatter","mode":"text","hoveron":"points","showlegend":false,"xaxis":"x","yaxis":"y","hoverinfo":"text","frame":null},{"x":[-24],"y":[11],"text":"(0.695,-0.719)","hovertext":"x: -24<br />y: 11","textfont":{"size":14.6645669291339,"color":"rgba(255,165,0,1)"},"type":"scatter","mode":"text","hoveron":"points","showlegend":false,"xaxis":"x","yaxis":"y","hoverinfo":"text","frame":null}],"layout":{"margin":{"t":43.7625570776256,"r":7.30593607305936,"b":40.1826484018265,"l":43.1050228310502},"plot_bgcolor":"rgba(255,255,255,1)","paper_bgcolor":"rgba(255,255,255,1)","font":{"color":"rgba(0,0,0,1)","family":"","size":14.6118721461187},"title":"Calificaciones (Escala 0-100)","titlefont":{"color":"rgba(0,0,0,1)","family":"","size":17.5342465753425},"xaxis":{"domain":[0,1],"automargin":true,"type":"linear","autorange":false,"range":[-33,33],"tickmode":"array","ticktext":["-20","0","20"],"tickvals":[-20,0,20],"categoryorder":"array","categoryarray":["-20","0","20"],"nticks":null,"ticks":"outside","tickcolor":"rgba(51,51,51,1)","ticklen":3.65296803652968,"tickwidth":0.66417600664176,"showticklabels":true,"tickfont":{"color":"rgba(77,77,77,1)","family":"","size":11.689497716895},"tickangle":-0,"showline":false,"linecolor":null,"linewidth":0,"showgrid":true,"gridcolor":"rgba(235,235,235,1)","gridwidth":0.66417600664176,"zeroline":false,"anchor":"y","title":"Historia","titlefont":{"color":"rgba(0,0,0,1)","family":"","size":14.6118721461187},"hoverformat":".2f"},"yaxis":{"domain":[0,1],"automargin":true,"type":"linear","autorange":false,"range":[-24.7383015,23.4423365],"tickmode":"array","ticktext":["-20","-10","0","10","20"],"tickvals":[-20,-10,-3.5527136788005e-015,10,20],"categoryorder":"array","categoryarray":["-20","-10","0","10","20"],"nticks":null,"ticks":"outside","tickcolor":"rgba(51,51,51,1)","ticklen":3.65296803652968,"tickwidth":0.66417600664176,"showticklabels":true,"tickfont":{"color":"rgba(77,77,77,1)","family":"","size":11.689497716895},"tickangle":-0,"showline":false,"linecolor":null,"linewidth":0,"showgrid":true,"gridcolor":"rgba(235,235,235,1)","gridwidth":0.66417600664176,"zeroline":false,"anchor":"x","title":"Geografía ","titlefont":{"color":"rgba(0,0,0,1)","family":"","size":14.6118721461187},"hoverformat":".2f"},"shapes":[{"type":"rect","fillcolor":"transparent","line":{"color":"rgba(51,51,51,1)","width":0.66417600664176,"linetype":"solid"},"yref":"paper","xref":"paper","x0":0,"x1":1,"y0":0,"y1":1}],"showlegend":false,"legend":{"bgcolor":"rgba(255,255,255,1)","bordercolor":"transparent","borderwidth":1.88976377952756,"font":{"color":"rgba(0,0,0,1)","family":"","size":11.689497716895}},"hovermode":"closest","barmode":"relative"},"config":{"doubleClick":"reset","modeBarButtonsToAdd":[{"name":"Collaborate","icon":{"width":1000,"ascent":500,"descent":-50,"path":"M487 375c7-10 9-23 5-36l-79-259c-3-12-11-23-22-31-11-8-22-12-35-12l-263 0c-15 0-29 5-43 15-13 10-23 23-28 37-5 13-5 25-1 37 0 0 0 3 1 7 1 5 1 8 1 11 0 2 0 4-1 6 0 3-1 5-1 6 1 2 2 4 3 6 1 2 2 4 4 6 2 3 4 5 5 7 5 7 9 16 13 26 4 10 7 19 9 26 0 2 0 5 0 9-1 4-1 6 0 8 0 2 2 5 4 8 3 3 5 5 5 7 4 6 8 15 12 26 4 11 7 19 7 26 1 1 0 4 0 9-1 4-1 7 0 8 1 2 3 5 6 8 4 4 6 6 6 7 4 5 8 13 13 24 4 11 7 20 7 28 1 1 0 4 0 7-1 3-1 6-1 7 0 2 1 4 3 6 1 1 3 4 5 6 2 3 3 5 5 6 1 2 3 5 4 9 2 3 3 7 5 10 1 3 2 6 4 10 2 4 4 7 6 9 2 3 4 5 7 7 3 2 7 3 11 3 3 0 8 0 13-1l0-1c7 2 12 2 14 2l218 0c14 0 25-5 32-16 8-10 10-23 6-37l-79-259c-7-22-13-37-20-43-7-7-19-10-37-10l-248 0c-5 0-9-2-11-5-2-3-2-7 0-12 4-13 18-20 41-20l264 0c5 0 10 2 16 5 5 3 8 6 10 11l85 282c2 5 2 10 2 17 7-3 13-7 17-13z m-304 0c-1-3-1-5 0-7 1-1 3-2 6-2l174 0c2 0 4 1 7 2 2 2 4 4 5 7l6 18c0 3 0 5-1 7-1 1-3 2-6 2l-173 0c-3 0-5-1-8-2-2-2-4-4-4-7z m-24-73c-1-3-1-5 0-7 2-2 3-2 6-2l174 0c2 0 5 0 7 2 3 2 4 4 5 7l6 18c1 2 0 5-1 6-1 2-3 3-5 3l-174 0c-3 0-5-1-7-3-3-1-4-4-5-6z"},"click":"function(gd) { \n        // is this being viewed in RStudio?\n        if (location.search == '?viewer_pane=1') {\n          alert('To learn about plotly for collaboration, visit:\\n https://cpsievert.github.io/plotly_book/plot-ly-for-collaboration.html');\n        } else {\n          window.open('https://cpsievert.github.io/plotly_book/plot-ly-for-collaboration.html', '_blank');\n        }\n      }"}],"cloud":false},"source":"A","attrs":{"a47aad4355":{"x":{},"y":{},"type":"scatter"},"a4648d62b":{"x":{},"y":{}},"a46a3b4684":{"intercept":{},"slope":{}},"a4673a1f70":{"intercept":{},"slope":{}},"a42faf404d":{"x":{},"y":{}},"a45977dec":{"x":{},"y":{}}},"cur_data":"a47aad4355","visdat":{"a47aad4355":["function (y) ","x"],"a4648d62b":["function (y) ","x"],"a46a3b4684":["function (y) ","x"],"a4673a1f70":["function (y) ","x"],"a42faf404d":["function (y) ","x"],"a45977dec":["function (y) ","x"]},"highlight":{"on":"plotly_click","persistent":false,"dynamic":false,"selectize":false,"opacityDim":0.2,"selected":{"opacity":1},"debounce":0},"base_url":"https://plot.ly"},"evals":["config.modeBarButtonsToAdd.0.click"],"jsHooks":[]}</script> Note que son ortogonales (perpendiculares).</p>
<pre class="r"><code># Plot de la varianza explicada por cada componente

plot(pve, xlab = &quot;Principal Component&quot;, 
     ylab = &quot;Proporción  de la varianza explicada&quot;, 
 ylim = c(0, 1), type = &quot;b&quot;)</code></pre>
<p><img src="/post/2019-02-24-PCA_files/figure-html/unnamed-chunk-16-1.png" width="672" /></p>
<pre class="r"><code># Plot proporción acumulada.
plot(cumsum(pve), xlab = &quot;Principal Component&quot;, 
     ylab = &quot;Cumulative Proportion of Variance Explained&quot;, 
     ylim = c(0, 1), type = &quot;b&quot;)</code></pre>
<p><img src="/post/2019-02-24-PCA_files/figure-html/unnamed-chunk-17-1.png" width="672" /></p>
</div>
</div>
<div id="proyeccion-de-los-datos-al-nuevo-espacio-vectorial-conformado-por-los-compornetes-principales." class="section level4">
<h4>Proyección de los datos al nuevo espacio vectorial conformado por los compornetes principales.</h4>
<pre class="r"><code># Multiplicamos  los datos (estandarizados) por la matriz de componentes principales.

loadings &lt;- pr$rotation
scores &lt;- pr$x
scores &lt;- as.data.frame(scores)</code></pre>
<pre class="r"><code>plt2&lt;-ggplot(scores,aes(PC1,PC2))+
         geom_point(color=&quot;darkblue&quot;, alpha=.5)+
         labs(title=&quot;Scores.Datos reproyectados con EigenVectores / PCs&quot;)+
   geom_abline(intercept = 0, slope = 0, color=&quot;yellow&quot;)+
  geom_abline(intercept = 0, slope = 90, color=&quot;red&quot;)+
  theme_light()+
  ylim(-10,10)+
  xlim(-30,30)+
  labs(x=&quot;PC1  97.5% var&quot;,y=&quot;PC2 2.5% var&quot;)
  
ggplotly(plt2)</code></pre>
<div id="htmlwidget-4" style="width:672px;height:480px;" class="plotly html-widget"></div>
<script type="application/json" data-for="htmlwidget-4">{"x":{"data":[{"x":[-3.48638346998875,21.7134877294012,3.49349911628418,3.73219344219152,8.67375350634794,-18.104872906485,29.3184669774699,-7.57168911384432,-18.2019447028326,4.88453378678567,-6.33087223326412,7.13287762864707,6.52228320355989,6.52312904751774,8.77935014540796,-18.5154524814917,9.36371943590102,0.486070350850926,20.7576755544682,-14.2841167051876,19.5908782477034,3.78268970567057,-7.02049450632977,14.8152790923822,25.2409355787457,-4.75921766234394,-10.9489187061666,-11.3902251185552,16.7802903682969,null,6.50175817051228,-6.61478013529266,-11.990073300837,-17.45988481231,-24.0474365946214,-7.42842905938308,12.0904655176168,5.63545927315432,-15.6783662762399,17.7949236264341,-13.7128768332258,-6.19898139554527,-6.22863488258993,-18.3754185537428,9.50112267122665,6.19249231004478,-5.22097843814803,-0.928545800025312,-0.846809265677436,5.39430494181996,8.23133994999585,-11.9105662890541,16.9235273644082,-15.6982988726013,9.24517178557682,-8.1149233054928,-6.97556870433452,15.7099038249057,-5.03265637374361,-3.62746778398641,10.1405249038122,-8.88066593514781,-20.7066285383879,3.52887197324137,-10.0204311926251,1.01067034013746,1.47190495880964,-22.1722086307752,-5.94088591157206,14.7161431667823,6.54838955959924,-2.60411031159159,16.121870618474,0.203681259473587,-3.56727641341847,-19.1579570357308,-2.08572954200889,18.3066916689584,-2.68608165291401,9.43705806086349,-4.43117791578243,-10.3345850076967,11.9217599494047,18.8359914812006,5.48147797941863,4.19928912189667,16.4768239247879,-1.45088331319776,-3.30078443310957,7.2946594357896,-2.61103775682319,2.97849341410229,6.63548998879443,15.2352721380669,-0.248387443058443,9.1001413675835,-8.21946382037225,-25.0005097692034,-9.1697215984096,1.29215855974019],"y":[-2.91634163128284,0.376570202452836,2.82388133518317,-0.457468385599367,-1.98206495431333,-0.902575906093338,-1.22771320123373,2.39524258655479,0.482504936043274,0.814911875494245,-4.55186283093149,-1.61000415011652,0.620501706892708,-0.433472120841172,2.60421316245186,-0.787807977265977,0.520653429295973,0.24126022750117,1.02315413045438,0.169840196474891,-2.38389556562086,-0.589325573020658,1.5264637750919,1.67879345011677,-1.8287956784511,-0.0015980024071367,-2.52655286438001,2.87247508432379,0.901878855049691,-3.86456601402116,-2.84941473243525,1.65311644002227,1.26699307003238,-0.916699622760635,3.78219886912716,1.26014674179288,-1.46960433480085,0.318226042374352,3.33980457747676,-0.058679315797793,0.728364720807592,-1.31756600697951,-1.36944289688332,0.205070378263656,1.64832965371593,-1.99461966339864,-1.78778754053818,3.41047399124134,-0.85805088125886,-3.43271442303945,0.429305264557245,-0.150626609563433,-0.281929405668656,1.04940976135831,-1.40751807775484,-0.740623843321329,-0.17412825444225,-0.490880644155765,-1.53096365368485,0.562320632626066,-0.696776699920224,3.54482195653766,-0.327337789865613,3.82244028581688,-3.04313059299151,0.8304649595261,2.17331899799727,2.05057400498678,1.53374694921324,-1.25302276316391,0.0419032568650959,3.12533436565476,1.74833459869093,-1.49665601235939,-5.21645887946895,-1.3948722323346,-1.81159862531513,-2.17361987261041,-1.81196060840764,3.56735040415065,-0.735233120961215,-1.45522486198102,-1.26537518958831,-0.303684694252537,-1.09460835916727,1.29986643887228,-1.0939111844244,-1.29353179578028,-1.38801520093181,1.53957437860406,-1.57905229563304,1.40659064526803,2.85329857608544,1.18133114875461,3.39434104209597,-0.26316245367783,1.31959968206342,-4.04692672066844,3.58872347742574,2.91173445017955],"text":["PC1:  -3.4863835<br />PC2: -2.916341631","PC1:  21.7134877<br />PC2:  0.376570202","PC1:   3.4934991<br />PC2:  2.823881335","PC1:   3.7321934<br />PC2: -0.457468386","PC1:   8.6737535<br />PC2: -1.982064954","PC1: -18.1048729<br />PC2: -0.902575906","PC1:  29.3184670<br />PC2: -1.227713201","PC1:  -7.5716891<br />PC2:  2.395242587","PC1: -18.2019447<br />PC2:  0.482504936","PC1:   4.8845338<br />PC2:  0.814911875","PC1:  -6.3308722<br />PC2: -4.551862831","PC1:   7.1328776<br />PC2: -1.610004150","PC1:   6.5222832<br />PC2:  0.620501707","PC1:   6.5231290<br />PC2: -0.433472121","PC1:   8.7793501<br />PC2:  2.604213162","PC1: -18.5154525<br />PC2: -0.787807977","PC1:   9.3637194<br />PC2:  0.520653429","PC1:   0.4860704<br />PC2:  0.241260228","PC1:  20.7576756<br />PC2:  1.023154130","PC1: -14.2841167<br />PC2:  0.169840196","PC1:  19.5908782<br />PC2: -2.383895566","PC1:   3.7826897<br />PC2: -0.589325573","PC1:  -7.0204945<br />PC2:  1.526463775","PC1:  14.8152791<br />PC2:  1.678793450","PC1:  25.2409356<br />PC2: -1.828795678","PC1:  -4.7592177<br />PC2: -0.001598002","PC1: -10.9489187<br />PC2: -2.526552864","PC1: -11.3902251<br />PC2:  2.872475084","PC1:  16.7802904<br />PC2:  0.901878855","PC1: -36.4555357<br />PC2: -3.864566014","PC1:   6.5017582<br />PC2: -2.849414732","PC1:  -6.6147801<br />PC2:  1.653116440","PC1: -11.9900733<br />PC2:  1.266993070","PC1: -17.4598848<br />PC2: -0.916699623","PC1: -24.0474366<br />PC2:  3.782198869","PC1:  -7.4284291<br />PC2:  1.260146742","PC1:  12.0904655<br />PC2: -1.469604335","PC1:   5.6354593<br />PC2:  0.318226042","PC1: -15.6783663<br />PC2:  3.339804577","PC1:  17.7949236<br />PC2: -0.058679316","PC1: -13.7128768<br />PC2:  0.728364721","PC1:  -6.1989814<br />PC2: -1.317566007","PC1:  -6.2286349<br />PC2: -1.369442897","PC1: -18.3754186<br />PC2:  0.205070378","PC1:   9.5011227<br />PC2:  1.648329654","PC1:   6.1924923<br />PC2: -1.994619663","PC1:  -5.2209784<br />PC2: -1.787787541","PC1:  -0.9285458<br />PC2:  3.410473991","PC1:  -0.8468093<br />PC2: -0.858050881","PC1:   5.3943049<br />PC2: -3.432714423","PC1:   8.2313399<br />PC2:  0.429305265","PC1: -11.9105663<br />PC2: -0.150626610","PC1:  16.9235274<br />PC2: -0.281929406","PC1: -15.6982989<br />PC2:  1.049409761","PC1:   9.2451718<br />PC2: -1.407518078","PC1:  -8.1149233<br />PC2: -0.740623843","PC1:  -6.9755687<br />PC2: -0.174128254","PC1:  15.7099038<br />PC2: -0.490880644","PC1:  -5.0326564<br />PC2: -1.530963654","PC1:  -3.6274678<br />PC2:  0.562320633","PC1:  10.1405249<br />PC2: -0.696776700","PC1:  -8.8806659<br />PC2:  3.544821957","PC1: -20.7066285<br />PC2: -0.327337790","PC1:   3.5288720<br />PC2:  3.822440286","PC1: -10.0204312<br />PC2: -3.043130593","PC1:   1.0106703<br />PC2:  0.830464960","PC1:   1.4719050<br />PC2:  2.173318998","PC1: -22.1722086<br />PC2:  2.050574005","PC1:  -5.9408859<br />PC2:  1.533746949","PC1:  14.7161432<br />PC2: -1.253022763","PC1:   6.5483896<br />PC2:  0.041903257","PC1:  -2.6041103<br />PC2:  3.125334366","PC1:  16.1218706<br />PC2:  1.748334599","PC1:   0.2036813<br />PC2: -1.496656012","PC1:  -3.5672764<br />PC2: -5.216458879","PC1: -19.1579570<br />PC2: -1.394872232","PC1:  -2.0857295<br />PC2: -1.811598625","PC1:  18.3066917<br />PC2: -2.173619873","PC1:  -2.6860817<br />PC2: -1.811960608","PC1:   9.4370581<br />PC2:  3.567350404","PC1:  -4.4311779<br />PC2: -0.735233121","PC1: -10.3345850<br />PC2: -1.455224862","PC1:  11.9217599<br />PC2: -1.265375190","PC1:  18.8359915<br />PC2: -0.303684694","PC1:   5.4814780<br />PC2: -1.094608359","PC1:   4.1992891<br />PC2:  1.299866439","PC1:  16.4768239<br />PC2: -1.093911184","PC1:  -1.4508833<br />PC2: -1.293531796","PC1:  -3.3007844<br />PC2: -1.388015201","PC1:   7.2946594<br />PC2:  1.539574379","PC1:  -2.6110378<br />PC2: -1.579052296","PC1:   2.9784934<br />PC2:  1.406590645","PC1:   6.6354900<br />PC2:  2.853298576","PC1:  15.2352721<br />PC2:  1.181331149","PC1:  -0.2483874<br />PC2:  3.394341042","PC1:   9.1001414<br />PC2: -0.263162454","PC1:  -8.2194638<br />PC2:  1.319599682","PC1: -25.0005098<br />PC2: -4.046926721","PC1:  -9.1697216<br />PC2:  3.588723477","PC1:   1.2921586<br />PC2:  2.911734450"],"type":"scatter","mode":"markers","marker":{"autocolorscale":false,"color":"rgba(0,0,139,1)","opacity":0.5,"size":5.66929133858268,"symbol":"circle","line":{"width":1.88976377952756,"color":"rgba(0,0,139,1)"}},"hoveron":"points","showlegend":false,"xaxis":"x","yaxis":"y","hoverinfo":"text","frame":null},{"x":[-33,33],"y":[0,0],"text":"intercept: 0<br />slope: 0","type":"scatter","mode":"lines","line":{"width":1.88976377952756,"color":"rgba(255,255,0,1)","dash":"solid"},"hoveron":"points","showlegend":false,"xaxis":"x","yaxis":"y","hoverinfo":"text","frame":null},{"x":[-33,33],"y":[-2970,2970],"text":"intercept: 0<br />slope: 90","type":"scatter","mode":"lines","line":{"width":1.88976377952756,"color":"rgba(255,0,0,1)","dash":"solid"},"hoveron":"points","showlegend":false,"xaxis":"x","yaxis":"y","hoverinfo":"text","frame":null}],"layout":{"margin":{"t":43.7625570776256,"r":7.30593607305936,"b":40.1826484018265,"l":43.1050228310502},"plot_bgcolor":"rgba(255,255,255,1)","paper_bgcolor":"rgba(255,255,255,1)","font":{"color":"rgba(0,0,0,1)","family":"","size":14.6118721461187},"title":"Scores.Datos reproyectados con EigenVectores / PCs","titlefont":{"color":"rgba(0,0,0,1)","family":"","size":17.5342465753425},"xaxis":{"domain":[0,1],"automargin":true,"type":"linear","autorange":false,"range":[-33,33],"tickmode":"array","ticktext":["-20","0","20"],"tickvals":[-20,0,20],"categoryorder":"array","categoryarray":["-20","0","20"],"nticks":null,"ticks":"outside","tickcolor":"rgba(179,179,179,1)","ticklen":3.65296803652968,"tickwidth":0.33208800332088,"showticklabels":true,"tickfont":{"color":"rgba(77,77,77,1)","family":"","size":11.689497716895},"tickangle":-0,"showline":false,"linecolor":null,"linewidth":0,"showgrid":true,"gridcolor":"rgba(222,222,222,1)","gridwidth":0.33208800332088,"zeroline":false,"anchor":"y","title":"PC1  97.5% var","titlefont":{"color":"rgba(0,0,0,1)","family":"","size":14.6118721461187},"hoverformat":".2f"},"yaxis":{"domain":[0,1],"automargin":true,"type":"linear","autorange":false,"range":[-11,11],"tickmode":"array","ticktext":["-10","-5","0","5","10"],"tickvals":[-10,-5,0,5,10],"categoryorder":"array","categoryarray":["-10","-5","0","5","10"],"nticks":null,"ticks":"outside","tickcolor":"rgba(179,179,179,1)","ticklen":3.65296803652968,"tickwidth":0.33208800332088,"showticklabels":true,"tickfont":{"color":"rgba(77,77,77,1)","family":"","size":11.689497716895},"tickangle":-0,"showline":false,"linecolor":null,"linewidth":0,"showgrid":true,"gridcolor":"rgba(222,222,222,1)","gridwidth":0.33208800332088,"zeroline":false,"anchor":"x","title":"PC2 2.5% var","titlefont":{"color":"rgba(0,0,0,1)","family":"","size":14.6118721461187},"hoverformat":".2f"},"shapes":[{"type":"rect","fillcolor":"transparent","line":{"color":"rgba(179,179,179,1)","width":0.66417600664176,"linetype":"solid"},"yref":"paper","xref":"paper","x0":0,"x1":1,"y0":0,"y1":1}],"showlegend":false,"legend":{"bgcolor":"rgba(255,255,255,1)","bordercolor":"transparent","borderwidth":1.88976377952756,"font":{"color":"rgba(0,0,0,1)","family":"","size":11.689497716895}},"hovermode":"closest","barmode":"relative"},"config":{"doubleClick":"reset","modeBarButtonsToAdd":[{"name":"Collaborate","icon":{"width":1000,"ascent":500,"descent":-50,"path":"M487 375c7-10 9-23 5-36l-79-259c-3-12-11-23-22-31-11-8-22-12-35-12l-263 0c-15 0-29 5-43 15-13 10-23 23-28 37-5 13-5 25-1 37 0 0 0 3 1 7 1 5 1 8 1 11 0 2 0 4-1 6 0 3-1 5-1 6 1 2 2 4 3 6 1 2 2 4 4 6 2 3 4 5 5 7 5 7 9 16 13 26 4 10 7 19 9 26 0 2 0 5 0 9-1 4-1 6 0 8 0 2 2 5 4 8 3 3 5 5 5 7 4 6 8 15 12 26 4 11 7 19 7 26 1 1 0 4 0 9-1 4-1 7 0 8 1 2 3 5 6 8 4 4 6 6 6 7 4 5 8 13 13 24 4 11 7 20 7 28 1 1 0 4 0 7-1 3-1 6-1 7 0 2 1 4 3 6 1 1 3 4 5 6 2 3 3 5 5 6 1 2 3 5 4 9 2 3 3 7 5 10 1 3 2 6 4 10 2 4 4 7 6 9 2 3 4 5 7 7 3 2 7 3 11 3 3 0 8 0 13-1l0-1c7 2 12 2 14 2l218 0c14 0 25-5 32-16 8-10 10-23 6-37l-79-259c-7-22-13-37-20-43-7-7-19-10-37-10l-248 0c-5 0-9-2-11-5-2-3-2-7 0-12 4-13 18-20 41-20l264 0c5 0 10 2 16 5 5 3 8 6 10 11l85 282c2 5 2 10 2 17 7-3 13-7 17-13z m-304 0c-1-3-1-5 0-7 1-1 3-2 6-2l174 0c2 0 4 1 7 2 2 2 4 4 5 7l6 18c0 3 0 5-1 7-1 1-3 2-6 2l-173 0c-3 0-5-1-8-2-2-2-4-4-4-7z m-24-73c-1-3-1-5 0-7 2-2 3-2 6-2l174 0c2 0 5 0 7 2 3 2 4 4 5 7l6 18c1 2 0 5-1 6-1 2-3 3-5 3l-174 0c-3 0-5-1-7-3-3-1-4-4-5-6z"},"click":"function(gd) { \n        // is this being viewed in RStudio?\n        if (location.search == '?viewer_pane=1') {\n          alert('To learn about plotly for collaboration, visit:\\n https://cpsievert.github.io/plotly_book/plot-ly-for-collaboration.html');\n        } else {\n          window.open('https://cpsievert.github.io/plotly_book/plot-ly-for-collaboration.html', '_blank');\n        }\n      }"}],"cloud":false},"source":"A","attrs":{"a425c77e48":{"x":{},"y":{},"type":"scatter"},"a4774c602a":{"intercept":{},"slope":{}},"a437061433":{"intercept":{},"slope":{}}},"cur_data":"a425c77e48","visdat":{"a425c77e48":["function (y) ","x"],"a4774c602a":["function (y) ","x"],"a437061433":["function (y) ","x"]},"highlight":{"on":"plotly_click","persistent":false,"dynamic":false,"selectize":false,"opacityDim":0.2,"selected":{"opacity":1},"debounce":0},"base_url":"https://plot.ly"},"evals":["config.modeBarButtonsToAdd.0.click"],"jsHooks":[]}</script>
</div>
<div id="representacion-de-scores-y-variables-con-biplot" class="section level4">
<h4>Representación de scores y variables con Biplot</h4>
<p>Creamos una representación gráfica con los scores (datos reproyectados <em>puntos</em>) y las variables (<strong>vectrores</strong>) en las misma grafica (“bi”).</p>
<pre class="r"><code>library(ggbiplot)

b2&lt;-ggbiplot(pr, circle = TRUE)+
    theme_light()+
  geom_point(color=&quot;gray&quot;)+
  geom_abline(intercept = 0, slope = 0, color=&quot;blue&quot;)+
  geom_abline(intercept = 0, slope = 90, color=&quot;lightgreen&quot;)+
  theme_light()

b2</code></pre>
<p><img src="/post/2019-02-24-PCA_files/figure-html/unnamed-chunk-20-1.png" width="576" /></p>
<p>Interpretación: Las variables se encuentran representadas como vectores. En este caso la dirección en la que apuntan indica la correlación positiva entre las variables de la matriz.</p>
<p>Cada punto corresponde al número de la observación en nuestra base de datos ortiginal. Ej. tenemos 100 obs, tenemos 100 datos en el biplot y las coordenadas corresponden con la ubicación en el espacio vectorial generado por los componentes princilaes.</p>
<p>En este caso podriamos usar unicamente una sola dimensión para explicar el desempeño de los alumnos en este grupo, (ej. el primer componente captura el <span class="math inline">\(97.5\%\)</span> de la variación total en los datos).</p>
<p>Note el círculo reresenta varianza de 1.5 en cada dirección.</p>
</div>
</div>
<div id="ejemplo-5-nacimientos-mexico-2016" class="section level3">
<h3>Ejemplo 5 Nacimientos México 2016</h3>
<p>El siguiente ejemplo considera la base de datos de nacimientos en México para 2017. La matriz contiene 236 774 observaciones (registros de nacimientos) para las siguientes variables:</p>
<p>GESTACH Semanas de gestación Rango aceptable 13 a 42 semanas</p>
<p>TALLAH Talla de recién nacido Rango aceptable 7 a 60 centímetros</p>
<p>PESOH largo 4 Peso del recién nacido Rango aceptable 20 a 6000 gramos,</p>
<p>APGARH Calificación obtenida del recién nacido a los cinco minutos del nacimiento Entre 0 a 10,</p>
<p>SILVERMAN Calificación obtenida del recién nacido al momento del nacimiento Entre 10 a 0</p>
<p>Y la variable categórica target con valores 0,1, Donde 0 denota nacimiento normal y 1 para indicar alguna anomalía o padecimiento.</p>
<p>El <strong>objetivo</strong> es aplicar el algoritmo <strong>PCA</strong> para explorar si es posible explicar la variación en los datos apartir de una estructura con menores dimensiones.</p>
<p>¿Con cuantos componentes principales podemos explicar el <span class="math inline">\(70\%\)</span> de la variación?</p>
<p>Adicionalmene determinar que variables estan correlacionadas.</p>
<p><a href="http://dgis.salud.gob.mx/contenidos/basesdedatos/std_nacimientos_gobmx.html">Fuente datos</a></p>
<div id="leemos-los-datos." class="section level5">
<h5>Leemos los datos.</h5>
<pre class="r"><code>df&lt;-readRDS(&quot;nac16set.rds&quot;)

str(df)</code></pre>
<pre><code>## &#39;data.frame&#39;:    236774 obs. of  7 variables:
##  $ pesoh     : int  2750 2750 3300 2450 3000 1620 9999 3100 3080 1525 ...
##  $ tallah    : int  50 50 52 49 50 42 49 51 50 99 ...
##  $ gestach   : int  38 38 41 36 37 34 41 40 38 33 ...
##  $ apgarh    : int  8 9 9 9 9 8 9 9 8 7 ...
##  $ silverman : int  3 0 0 0 0 4 0 2 1 0 ...
##  $ edad_madre: int  19 23 24 20 37 17 20 19 20 21 ...
##  $ target    : num  1 1 1 1 1 1 1 1 1 1 ...</code></pre>
<pre class="r"><code>names(df)</code></pre>
<pre><code>## [1] &quot;pesoh&quot;      &quot;tallah&quot;     &quot;gestach&quot;    &quot;apgarh&quot;     &quot;silverman&quot; 
## [6] &quot;edad_madre&quot; &quot;target&quot;</code></pre>
<pre class="r"><code>head(df,5)</code></pre>
<pre><code>##   pesoh tallah gestach apgarh silverman edad_madre target
## 1  2750     50      38      8         3         19      1
## 2  2750     50      38      9         0         23      1
## 3  3300     52      41      9         0         24      1
## 4  2450     49      36      9         0         20      1
## 5  3000     50      37      9         0         37      1</code></pre>
<pre class="r"><code>## Descriptivas

summary(df)</code></pre>
<pre><code>##      pesoh          tallah         gestach          apgarh      
##  Min.   : 186   Min.   :27.00   Min.   :18.00   Min.   : 0.000  
##  1st Qu.:2810   1st Qu.:48.00   1st Qu.:38.00   1st Qu.: 9.000  
##  Median :3152   Median :50.00   Median :39.00   Median : 9.000  
##  Mean   :3617   Mean   :51.32   Mean   :38.31   Mean   : 9.404  
##  3rd Qu.:3540   3rd Qu.:52.00   3rd Qu.:40.00   3rd Qu.: 9.000  
##  Max.   :9999   Max.   :99.00   Max.   :99.00   Max.   :99.000  
##    silverman       edad_madre         target   
##  Min.   : 0.00   Min.   :  9.00   Min.   :0.0  
##  1st Qu.: 0.00   1st Qu.: 20.00   1st Qu.:0.0  
##  Median : 0.00   Median : 25.00   Median :0.5  
##  Mean   : 1.64   Mean   : 25.99   Mean   :0.5  
##  3rd Qu.: 0.00   3rd Qu.: 30.00   3rd Qu.:1.0  
##  Max.   :99.00   Max.   :999.00   Max.   :1.0</code></pre>
<pre class="r"><code># Eliminamos valores inválidos. ej. 99 0 9999.

df&lt;-filter(df,edad_madre!=999|apgarh!=99,silverman!=99,tallah!=99,gestach!=99,pesoh!=9999)

# Valor promedio de todas las variables  para cada grupo?

df_mean&lt;-group_by(df,target)%&gt;%
  summarise_all(list(mean))

df_mean</code></pre>
<pre><code>## # A tibble: 2 x 7
##   target pesoh tallah gestach apgarh silverman edad_madre
##    &lt;dbl&gt; &lt;dbl&gt;  &lt;dbl&gt;   &lt;dbl&gt;  &lt;dbl&gt;     &lt;dbl&gt;      &lt;dbl&gt;
## 1      0 3152.   50.0    38.8   9.29     0.219       25.9
## 2      1 2967.   48.8    37.8   8.93     0.639       25.9</code></pre>
<pre class="r"><code>df&lt;-mutate(df,target=as.factor(target))

p&lt;-ggplot(df,aes(pesoh,fill=target))+
  geom_histogram(position= &quot;identity&quot;, alpha=0.4)+
  theme_light()+
  labs(fill=&quot;Anomalia&quot;, y=&quot;nacimientos&quot;, x=&quot;Peso (g)&quot;)+
scale_fill_discrete(labels=c(&quot;No&quot;, &quot;Sí&quot;))
  p   </code></pre>
<p><img src="/post/2019-02-24-PCA_files/figure-html/unnamed-chunk-22-1.png" width="672" /></p>
<pre class="r"><code># Matriz de correlación

df_matrix&lt;-select(df, -c(target))

M &lt;- round(cor(df_matrix), 2)

corrplot(M, diag = FALSE, method=&quot;color&quot;, order=&quot;FPC&quot;, tl.srt = 90)</code></pre>
<p><img src="/post/2019-02-24-PCA_files/figure-html/unnamed-chunk-23-1.png" width="672" /></p>
</div>
<div id="estimacion-de-pca." class="section level4">
<h4>3. Estimación de PCA.</h4>
<pre class="r"><code>df.cp &lt;- prcomp(df_matrix, scale = TRUE, center = TRUE)
df.cp</code></pre>
<pre><code>## Standard deviations (1, .., p=6):
## [1] 1.6188248 1.0035523 1.0000301 0.9547178 0.5151235 0.4420301
## 
## Rotation (n x k) = (6 x 6):
##                    PC1         PC2          PC3         PC4          PC5
## pesoh       0.56362003 -0.08340421  0.031961539 -0.13013833 -0.472278436
## tallah      0.56834147 -0.07402666  0.020334921 -0.11463638 -0.317399298
## gestach     0.55660883 -0.05670072  0.001240849 -0.06991023  0.820836468
## apgarh      0.05526126  0.92747835 -0.108682130 -0.35340628 -0.003670461
## silverman  -0.21531967 -0.32794706  0.068827291 -0.91604950  0.046174662
## edad_madre -0.00952225  0.12877676  0.990966402  0.03150213  0.017108058
##                     PC6
## pesoh      -0.659068851
## tallah      0.746465472
## gestach    -0.091160032
## apgarh     -0.002970418
## silverman   0.008495878
## edad_madre  0.005137485</code></pre>
<pre class="r"><code>#  Parámetros para graficar.
par(mfrow = c(1, 2))

# # Eigenvalores  (loadings). Varianza en cada componente.
cp.var &lt;- df.cp$sdev ^ 2
round(cp.var, 2)</code></pre>
<pre><code>## [1] 2.62 1.01 1.00 0.91 0.27 0.20</code></pre>
<pre class="r"><code>cp.var</code></pre>
<pre><code>## [1] 2.6205937 1.0071172 1.0000602 0.9114860 0.2653522 0.1953906</code></pre>
<pre class="r"><code># Proporción de la varianza de cada componente
pve &lt;- cp.var/sum(cp.var)
round(pve, 2)</code></pre>
<pre><code>## [1] 0.44 0.17 0.17 0.15 0.04 0.03</code></pre>
<pre class="r"><code># Porcentaje Acumulado explicado.
round(cumsum(pve), 2)</code></pre>
<pre><code>## [1] 0.44 0.60 0.77 0.92 0.97 1.00</code></pre>
<p>El 77% de la varianza es explicada por los primeros 3 componentes. Los tres primeros <span class="math inline">\(\lambda\geq1\)</span>, acorde al criterio de Kaiser podriamos mantener 3 cp.</p>
</div>
<div id="scree-plot-para-mostrar-la-varianza-explicada-por-cada-componente." class="section level4">
<h4>Scree plot para mostrar la varianza explicada por cada componente.</h4>
<pre class="r"><code># Plot variance explained para cada  componente principal 

plot(pve, xlab = &quot;Principal Component&quot;, 
     ylab = &quot;Pr varianza explicada&quot;, 
     ylim = c(0, 1), type = &quot;b&quot;)</code></pre>
<p><img src="/post/2019-02-24-PCA_files/figure-html/unnamed-chunk-26-1.png" width="672" /></p>
<pre class="r"><code># Plot  proportion acumulada  de varianza explcada 

plot(cumsum(pve), xlab = &quot;Principal Component&quot;, 
     ylab = &quot;Cumulative Proportion of Variance Explained&quot;, 
     ylim = c(0, 1), type = &quot;b&quot;)</code></pre>
<p><img src="/post/2019-02-24-PCA_files/figure-html/unnamed-chunk-27-1.png" width="672" /></p>
</div>
</div>
</div>
<div class="footnotes">
<hr />
<ol>
<li id="fn1"><p>Sugerencia: Jean Paul Bencecri sobre orígenes de este vínculo entre Multivariate Analysis Data Analysis y Principal Componentes<a href="#fnref1">↩</a></p></li>
<li id="fn2"><p>Estre criterio , denominado regla de Kaiser, parte de la idea de que un <span class="math inline">\(\lambda=1\)</span> equivale a la variación promedio aportada por un componente cualesquiera en el conjunto, entonces renterner aquellos que aportan mas de la variación promedio intuitivamente tiene sentido.<a href="#fnref2">↩</a></p></li>
<li id="fn3"><p>Traza: Suma de los elementos de la diagonal de una matriz nxn<a href="#fnref3">↩</a></p></li>
</ol>
</div>

		</div>
		
<div class="post__tags tags clearfix">
	<svg class="icon icon-tag" width="16" height="16" viewBox="0 0 16 16"><path d="M16 9.5c0 .373-.24.74-.5 1l-5 5c-.275.26-.634.5-1 .5-.373 0-.74-.24-1-.5L1 8a2.853 2.853 0 0 1-.7-1C.113 6.55 0 5.973 0 5.6V1.4C0 1.034.134.669.401.401.67.134 1.034 0 1.4 0h4.2c.373 0 .95.113 1.4.3.45.187.732.432 1 .7l7.5 7.502c.26.274.5.632.5.998zM3.5 5a1.5 1.5 0 1 0 0-3 1.5 1.5 0 0 0 0 3z"/></svg>
	<ul class="tags__list">
		<li class="tags__item"><a class="tags__link btn" href="/tags/pca/" rel="tag">PCA</a></li>
		<li class="tags__item"><a class="tags__link btn" href="/tags/clustering/" rel="tag">clustering</a></li>
		<li class="tags__item"><a class="tags__link btn" href="/tags/classification/" rel="tag">classification</a></li>
		<li class="tags__item"><a class="tags__link btn" href="/tags/unsupervised-statistical-learning/" rel="tag">unsupervised statistical learning</a></li>
	</ul>
</div>
	</article>
</main>

<div class="authorbox clearfix">
	<figure class="authorbox__avatar">
		<img alt="José Luis Manzanares Rivera avatar" src="/img/aavatar.jpg" class="avatar" height="90" width="90">
	</figure>
	<div class="authorbox__header">
		<span class="authorbox__name">About José Luis Manzanares Rivera</span>
	</div>
	<div class="authorbox__description">
		José Luis is a data scientist. He is currently conducting applied research at El Colegio de la Frontera Norte.
	</div>
</div>

<nav class="post-nav flex">
	<div class="post-nav__item post-nav__item--prev">
		<a class="post-nav__link" href="/post/2019-01-25-rl5/" rel="prev"><span class="post-nav__caption">«&thinsp;Previous</span><p class="post-nav__post-title">RL-Multiple</p></a>
	</div>
	<div class="post-nav__item post-nav__item--next">
		<a class="post-nav__link" href="/post/2019-02-05-rl6/" rel="next"><span class="post-nav__caption">Next&thinsp;»</span><p class="post-nav__post-title">RL-Diagnóstico</p></a>
	</div>
</nav>

<section class="comments">
	<div id="disqus_thread"></div>
<script type="application/javascript">
    var disqus_config = function () {
    
    
    
    };
    (function() {
        if (["localhost", "127.0.0.1"].indexOf(window.location.hostname) != -1) {
            document.getElementById('disqus_thread').innerHTML = 'Disqus comments not available by default when the website is previewed locally.';
            return;
        }
        var d = document, s = d.createElement('script'); s.async = true;
        s.src = '//' + "4insight" + '.disqus.com/embed.js';
        s.setAttribute('data-timestamp', +new Date());
        (d.head || d.body).appendChild(s);
    })();
</script>
<noscript>Please enable JavaScript to view the <a href="https://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>
<a href="https://disqus.com" class="dsq-brlink">comments powered by <span class="logo-disqus">Disqus</span></a>
</section>


			</div>
			<aside class="sidebar"><div class="widget-search widget">
	<form class="widget-search__form" role="search" method="get" action="https://google.com/search">
		<label>
			<input class="widget-search__field" type="search" placeholder="SEARCH..." value="" name="q" aria-label="SEARCH...">
		</label>
		<input class="widget-search__submit" type="submit" value="Search">
		<input type="hidden" name="sitesearch" value="/" />
	</form>
</div>
<div class="widget-recent widget">
	<h4 class="widget__title">Recent Posts</h4>
	<div class="widget__content">
		<ul class="widget__list">
			<li class="widget__item"><a class="widget__link" href="/post/2019-04-19-clustering_knn/">Clasifiación</a></li>
			<li class="widget__item"><a class="widget__link" href="/post/2019-04-16-logistic3/">Logistic3</a></li>
			<li class="widget__item"><a class="widget__link" href="/post/2019-04-15-logistic2/">Logistic2</a></li>
			<li class="widget__item"><a class="widget__link" href="/post/2019-02-25-logistic/">Logistic</a></li>
			<li class="widget__item"><a class="widget__link" href="/post/2019-02-05-rl6/">RL-Diagnóstico</a></li>
		</ul>
	</div>
</div>
<div class="widget-categories widget">
	<h4 class="widget__title">Categories</h4>
	<div class="widget__content">
		<ul class="widget__list">
			<li class="widget__item"><a class="widget__link" href="/categories/development">Development</a></li>
			<li class="widget__item"><a class="widget__link" href="/categories/r">R</a></li>
		</ul>
	</div>
</div>
<div class="widget-taglist widget">
	<h4 class="widget__title">Tags</h4>
	<div class="widget__content">
		<a class="widget-taglist__link widget__link btn" href="/tags/basic-elements" title="Basic elements">Basic elements</a>
		<a class="widget-taglist__link widget__link btn" href="/tags/classification" title="Classification">Classification</a>
		<a class="widget-taglist__link widget__link btn" href="/tags/clustering" title="Clustering">Clustering</a>
		<a class="widget-taglist__link widget__link btn" href="/tags/css" title="Css">Css</a>
		<a class="widget-taglist__link widget__link btn" href="/tags/glm" title="Glm">Glm</a>
		<a class="widget-taglist__link widget__link btn" href="/tags/html" title="Html">Html</a>
		<a class="widget-taglist__link widget__link btn" href="/tags/knn" title="Knn">Knn</a>
		<a class="widget-taglist__link widget__link btn" href="/tags/lda" title="Lda">Lda</a>
		<a class="widget-taglist__link widget__link btn" href="/tags/logistic" title="Logistic">Logistic</a>
		<a class="widget-taglist__link widget__link btn" href="/tags/logodds" title="Logodds">Logodds</a>
		<a class="widget-taglist__link widget__link btn" href="/tags/mco" title="Mco">Mco</a>
		<a class="widget-taglist__link widget__link btn" href="/tags/pca" title="Pca">Pca</a>
		<a class="widget-taglist__link widget__link btn" href="/tags/regresi%c3%b3n-lineal" title="Regresión lineal">Regresión lineal</a>
		<a class="widget-taglist__link widget__link btn" href="/tags/regression" title="Regression">Regression</a>
		<a class="widget-taglist__link widget__link btn" href="/tags/unsupervised-statistical-learning" title="Unsupervised statistical learning">Unsupervised statistical learning</a>
	</div>
</div>
</aside>
		</div>
		<footer class="footer">
	<div class="container footer__container flex">
		
		<div class="footer__copyright">
			&copy; 2019 Estadística II.
			<span class="footer__copyright-credits">Generated with <a href="https://gohugo.io/" rel="nofollow noopener" target="_blank">Hugo</a> and <a href="https://github.com/Vimux/Mainroad/" rel="nofollow noopener" target="_blank">Mainroad</a> theme.</span>
		</div>
	</div>
</footer>
	</div>
<script async defer src="/js/menu.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js?config=TeX-AMS-MML_HTMLorMML" async></script>
</body>
</html>