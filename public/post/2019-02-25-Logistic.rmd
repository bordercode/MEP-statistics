---
title: "Logistic"
author: "JLMR"
date: 2019-02-28T21:14:14-05:00
categories: ["R"]
tags: ["Logistic", "log(odds)", "glm"]
mathjax : true
menu:
  main:
    name: Logistic R
    weight: 15
---


```{r set-global-options, echo=FALSE, message=FALSE, warning=FALSE}
knitr::opts_chunk$set(eval = TRUE, 
                      echo = TRUE, 
                      cache = FALSE,
                      include = TRUE,
                      collapse = FALSE,
                      dependson = NULL,
                      engine = "R", # Chunks will always have R code, unless noted
                      error = FALSE)   


```



```{r silent-packages, echo = FALSE, eval = TRUE, message=FALSE, include = FALSE}
library(tidyverse)
library(ISLR)
library(foreign)
library(scales)
```



### Por qué el modelo de Regresión Logística?

En los casos anteriores hemos considerado que nuestros datos son númericos (variables contínuas o discretas pero de naturaleza cuantitativa).

Para el caso del **modelo de regresión logistica** nos interesa hacer predicciones para  variables **categóricas**.  

Reponder preguntas como: Cuál es la probabilidad de que un individuo partenezca a la categoría **i**? dado un conjunto de características ($x_i, ...,x_n$).

Ejemplo  1. Dado un conjunto de textos de Twitter, determinar cuales pertenecen a un sentimiento positivo y cuáles a un sentimiento negativo.

Ejemplo 2. Dadas las características de la madre, como edad, sexo, semanas de gestación, procedimiento cesárea o no, peso y talla del bebé determinar la probabilidad de que el bebé presente el padecimiento x. 


El modelo de regressión logística nos permite **clasificar**. Predecir una respuesta cualitativa ej. asignar a una categoria determinada las observaciones en un conjunto de datos se puede realizar mediante el modelo  de regressión logística.

El proceso de clasificación implica determinar la **probabilidad** de que la observación *i* pretenezca a una determinada categoría. Lo que se puede lograr a partir del modelo de regresión logística.

**Escenario 1**

Dado el nivel de ingreso (variable *income*) y el saldo (variable *balance*)  de la targeta de crédito en una muestra de 10,000 estudiantes, ¿Cuál es la probabilidad de que un individuo de la muestra, incumpla el pago de su deuda? (*Default*). 

El primer paso para aproximar la solución de este problema de clasificación es representar las variables de interés. 

Note que la variable dependiente (**Y**) es *Default* y las explicativas (**x_1,...,X_n**) son *income* y *balance*.

```{r, echo=FALSE, message=FALSE, warning=FALSE}
d<-Default
str(d)
names(d)

p<-ggplot(d,aes(balance, income, colour=default, shape=default))+
  geom_point()+
  theme_light()+
  scale_shape_manual(values=c(1,3))+
  scale_colour_manual(values = c("orange", "darkgreen"))+
  scale_x_continuous(labels = dollar_format())+
  scale_y_continuous(labels = dollar_format())

p
```

## Distribución de lso datos (Boxplot).

```{r, echo=FALSE, message=FALSE, warning=FALSE}
library(gridExtra)

bxp1<-ggplot(d,aes(default, balance))+
  geom_boxplot(aes(fill=default))+
  theme_light()+
  scale_y_continuous(labels = dollar_format())+
  scale_fill_manual(values = c("orange", "darkgreen"))+
  theme(legend.position = "none")


bxp2<-ggplot(d,aes(default, income))+
  geom_boxplot(aes(fill=default))+
  theme_light()+
  scale_y_continuous(labels = dollar_format())+
  scale_fill_manual(values = c("orange", "darkgreen"))+
  theme(legend.position = "none")




grid.arrange(bxp1, bxp2, nrow = 1)

```


Note la relación positiva entre la variable saldo 
y el incumplimiento. Así mismo relación inversa respecto al ingreso, aparentemente aquellos individuos de menor ingreso tiene mayor problema de incumplimiento. 


##### Preeliminares Contraste de regresión logística respecto a regresión linear con OLS. 



**Escenatio 2**

Suponga que tenemos una situación en la que debemos clasificar el estado de un  paciente en  sobredosis o paro cardiaco

\begin{equation}
  Y=\left\{
  \begin{array}{@{}ll@{}}
    0, & \text{si}\ paro cardiáco \\
    1, & \text{sobredosis}
  \end{array}\right.
\end{equation} 


En este caso particular **binario** podríamos estimar un modelo **RL** con **MCO**  y considerar sobredosis si $\hat Y>.5 $ 

Sin embargo, nuestros estimados de **MCO** no necesariamente se ubicarian en el intervalo [0,1] y por lo tanto su interpretación como probabilidades no es intutiva.

Aún más, el enfoque de **MCO** para variables cualitativas en un caso no binario, ej. 3 o 4 categor[ias, carece de sentido totalmente, ya que lo que importa es el significado de cada categoría pero su orden no tiene mayor implicación cuando estimamos el modelo de regresión logística.

Mientras que al cambiar el orden de la variable dependiente en el modelo lineal generariamos resultados diferentes y predicciones inconsistentes. 
